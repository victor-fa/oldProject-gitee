<app-left-nav></app-left-nav>
<div class="user" [ngStyle]="{'left': !commonService.isLeftNavClose ? 'calc(240px)' : 'calc(80px)','width': !commonService.isLeftNavClose ? 'calc(100% - 240px)' : 'calc(100% - 80px)'}">
  <nz-card>
    <nz-card-tab>
      <nz-tabset nzSize="large" [(nzSelectedIndex)]="tabsetJson.currentNum">
        <nz-tab [nzTitle]="userTemplate" (nzClick)="changePanel('user')" *ngIf="commonService.haveMenuPermission('children', '用户信息')">
          <ng-template #userTemplate><i class="anticon anticon-user"></i>用户信息</ng-template>
          <form [formGroup]="searchUserForm">
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="3">
                <input nz-input [(ngModel)]="userOrderPhone" formControlName="phone" placeholder="输入用户账号" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">用户状态：</div>
              <div nz-col nzSpan="3">
                <nz-select [(ngModel)]="userLocked" formControlName="locked">
                  <nz-option required [nzLabel]="'全部'" nzValue=""></nz-option>
                  <nz-option required [nzLabel]="'正常'" nzValue="false"></nz-option>
                  <nz-option required [nzLabel]="'冻结'" nzValue="true"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">用户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="userId" placeholder="输入用户ID" nzSize="default">
              </div>
              <div nz-col nzSpan="7"></div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="loadData('user')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">注册时间：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'userRegister')"></nz-range-picker>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">登录时间：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'userLogin')"></nz-range-picker>
              </div>
            </div>
          </form>

          <nz-table nzBordered #rowSelectionUserTable [nzData]="userData" [nzSimple]="true" [nzScroll]="{x:'1800px'}" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户ID</th>
                <th>用户账号</th>
                <th>用户昵称</th>
                <th>小悟币余额</th>
                <th>冻结小悟币</th>
                <th>小悟豆余额</th>
                <th>冻结小悟豆</th>
                <th>免密支付</th>
                <th>注册时间</th>
                <th>上次登录时间</th>
                <th>用户状态</th>
                <th>APP版本</th>
                <th>充值记录</th>
                <th>开票记录</th>
                <th>消费记录</th>
                <th>常用信息</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionUserTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.userId}}</td>
                <td>{{data.account}}</td>
                <td>{{data.nickname}}</td>
                <td>{{data.availableAmount}}</td>
                <td>{{data.blockedAmount}}</td>
                <td>{{data.availableBeans}}</td>
                <td>{{data.blockedBeans}}</td>
                <td>{{data.autoPayment === true ? '开启' : data.autoPayment === false ? '关闭' : 'null'}}</td>
                <td>{{data.registerAt | date:'yyyy-MM-dd HH:mm:ss' }}</td>
                <td><a (click)="showModal('latestLoginAt', data)">{{data.latestLoginAt | date:'yyyy-MM-dd HH:mm:ss' }}</a></td>
                <td>{{data.locked === true ? '冻结' : data.locked === false ? '正常' : 'null' }}</td>
                <td>--</td>
                <td><a (click)="showModal('goBusiness', data)">查看</a></td>
                <td><a (click)="showModal('goInvoice', data)">查看</a></td>
                <td><a (click)="showModal('goBooking', data)">查看</a></td>
                <td><a (click)="showModal('userCommon', data)">查看</a></td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('UserInfo', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>查看</button>
                  <button nz-button nzType="primary" *ngIf="data.locked === false" (click)="showModal('Blacklist', data)" style="margin-right: 10px;"><i class="anticon anticon-warning"></i>冻结</button>
                  <button nz-button nzType="primary" *ngIf="data.locked === true" (click)="showModal('UnlockUser', data)" style="margin-right: 10px;"><i class="anticon anticon-warning"></i>解冻</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.userInfoDetail" nzWidth="950" nzTitle="用户详情" [nzFooter]="userInfoDetailVisibleModalFooter" (nzOnCancel)="hideModal('UserInfo')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.account}}</div>
              <div nz-col nzSpan="4" class="right_alignment">用户昵称：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.nickname}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">小悟币余额：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.availableAmount}}</div>
              <div nz-col nzSpan="4" class="right_alignment">冻结小悟币：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.blockedAmount}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">小悟豆余额：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.availableBeans}}</div>
              <div nz-col nzSpan="4" class="right_alignment">冻结小悟豆：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.blockedBeans}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">免密支付：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.autoPayment === true ? '开启' : userInfoDetail.autoPayment === false ? '关闭' : 'null'}}</div>
              <div nz-col nzSpan="4" class="right_alignment">免密每单限额：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.autoPaymentCeiling}}</div>
            </div>
            <div nz-row>
                <div nz-col nzSpan="4" class="right_alignment">免密每日限额：</div>
                <div nz-col nzSpan="8">{{userInfoDetail.autoPaymentDailyTotal}}</div>
                <div nz-col nzSpan="4" class="right_alignment">用户状态：</div>
                <div nz-col nzSpan="8">{{userInfoDetail.locked === true ? '冻结' : userInfoDetail.locked === false ? '正常' : 'null' }}</div>
            <div nz-row>
            </div>
              <div nz-col nzSpan="4" class="right_alignment">注册时间：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.registerAt | date:'yyyy-MM-dd HH:mm:ss'}}</div>
              <div nz-col nzSpan="4" class="right_alignment">登录时间：</div>
              <div nz-col nzSpan="8">{{userInfoDetail.latestLoginAt | date:'yyyy-MM-dd HH:mm:ss'}}</div>
            </div>
            <!-- <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开启权限：</div>
              <div nz-col nzSpan="20">{{userInfoDetail.aaaa}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">优惠券：</div>
            </div> -->

            <!-- <nz-table nzBordered #rowSelectionUserDetailTable [nzData]="[{}]">
              <thead>
                <tr>
                  <th>序号</th>
                  <th>优惠券名称</th>
                  <th>优惠券类型</th>
                  <th>优惠券时间</th>
                  <th>优惠券金额</th>
                  <th>互斥规则</th>
                  <th>优惠券状态</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionUserDetailTable.data; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.aaaaa}}</td>
                  <td>{{data.aaaaa}}</td>
                  <td>{{data.aaaaa}}</td>
                  <td>{{data.aaaaa}}</td>
                  <td>{{data.aaaaa}}</td>
                  <td>{{data.aaaaa}}</td>
                </tr>
              </tbody>
            </nz-table> -->
            <ng-template #userInfoDetailVisibleModalFooter>
              <button nz-button nzType="default" (click)="hideModal('UserInfo')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.userInfoCommon" nzWidth="950" nzTitle="常用信息" [nzFooter]="userInfoCommonVisibleModalFooter" (nzOnCancel)="hideModal('UserCommon')" nzMaskClosable="false">
            <div nz-row>
              <nz-radio-group [(ngModel)]="currentUserCommonTab" (ngModelChange)="onChange($event, 'currentUserCommonTab')">
                <label nz-radio nzValue="TRAVELER">出行人</label>
                <label nz-radio nzValue="CONTACTS">联系人</label>
                <label nz-radio nzValue="DELIVERY_ADDRESS">配送地址</label>
                <label nz-radio nzValue="TRAVEL_ADDRESS">出行地址</label>
                <label nz-radio nzValue="INVOICE_TITLE">发票抬头</label>
              </nz-radio-group>
            </div>

            <nz-table nzBordered #rowSelectionUserCommon1Table [nzData]="userInfoCommonData" *ngIf="currentUserCommonTab === 'TRAVELER'">
              <thead>
                <tr> <th>序号</th> <th>姓名</th> <th>性别</th> <th>证件类型</th> <th>证件号</th> <th>出生日期</th> <th>手机号</th> <th>是否默认</th> </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionUserCommon1Table.data; let i=index;">
                  <td>{{i+1}}</td> <td>{{data.cName}}</td> <td>{{data.sex === 0 ? '男' : data.sex === 1 ? '女' : 'null'}}</td>
                  <td>{{data.iDType === 1 ? '身份证' : data.iDType === 2 ? '护照' : data.iDType === 3 ? '内地前往台湾通行证' : data.iDType === 4 ? '内地前往港澳通行证' : data.iDType === 5 ? '港澳回乡证' : data.iDType === 6 ? '台湾回乡证' : data.iDType === 7 ? '军官证' : data.iDType === 8 ? '士兵证' : 'null'}}</td>
                  <td>{{data.iDNumber}}</td> <td>{{data.birthday}}</td> <td>{{data.contactPhone}}</td> <td>{{data.defaultCon ? '是' : '否'}}</td>
                </tr>
              </tbody>
            </nz-table>

            <nz-table nzBordered #rowSelectionUserCommon2Table [nzData]="userInfoCommonData" *ngIf="currentUserCommonTab === 'CONTACTS'">
              <thead> <tr> <th>序号</th> <th>姓名</th> <th>手机号</th> <th>是否默认</th> </tr> </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionUserCommon2Table.data; let i=index;">
                  <td>{{i+1}}</td> <td>{{data.name}}</td> <td>{{data.phone}}</td> <td>{{data.exist ? '是' : '否'}}</td>
                </tr>
              </tbody>
            </nz-table>

            <nz-table nzBordered #rowSelectionUserCommon3Table [nzData]="userInfoCommonData" *ngIf="currentUserCommonTab === 'DELIVERY_ADDRESS'">
              <thead> <tr> <th>序号</th> <th>姓名</th> <th>手机号</th> <th>配送地址</th> <th>是否默认</th> </tr> </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionUserCommon3Table.data; let i=index;">
                  <td>{{i+1}}</td> <td>{{data.name}}</td> <td>{{data.mobile}}</td> <td>{{data.address}}</td> <td>{{data.defaultParam ? '是' : '否'}}</td>
                </tr>
              </tbody>
            </nz-table>

            <nz-table nzBordered #rowSelectionUserCommon4Table [nzData]="userInfoCommonData" *ngIf="currentUserCommonTab === 'TRAVEL_ADDRESS'">
              <thead> <tr> <th>序号</th> <th>标签</th> <th>地址</th> </tr> </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionUserCommon4Table.data; let i=index;"> <td>{{i+1}}</td> <td>{{data.title}}</td> <td>{{data.name}}</td> </tr>
              </tbody>
            </nz-table>

            <div *ngIf="currentUserCommonTab === 'INVOICE_TITLE'">
              <ng-container *ngFor="let data of userInfoCommonData; let i=index;">
                <ng-container *ngIf="data.type === true" style="background-color: #a9a9a9">
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">发票类型：</div>
                    <div nz-col nzSpan="5">企业</div>
                    <div nz-col nzSpan="3" class="right_alignment">企业名称：</div>
                    <div nz-col nzSpan="5">{{data.invoiceName ? data.invoiceName : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">纳税人识别号：</div>
                    <div nz-col nzSpan="5">{{data.dutyParagraph ? data.dutyParagraph : 'null'}}</div>
                  </div>
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">邮箱：</div>
                    <div nz-col nzSpan="5">{{data.email ? data.email : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">手机号：</div>
                    <div nz-col nzSpan="5">{{data.phone ? data.phone : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">注册地址：</div>
                    <div nz-col nzSpan="5">{{data.registerAdd ? data.registerAdd : 'null'}}</div>
                  </div>
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">注册电话：</div>
                    <div nz-col nzSpan="5">{{data.registerPhone ? data.registerPhone : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">开户银行：</div>
                    <div nz-col nzSpan="5">{{data.bank ? data.bank : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">开户账号：</div>
                    <div nz-col nzSpan="5">{{data.account ? data.account : 'null'}}</div>
                  </div>
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">是否默认：</div>
                    <div nz-col nzSpan="5">{{data.default === true ? '是' : data.default === false ? '否' : 'null'}}</div>
                  </div>
                </ng-container>

                <ng-container *ngIf="data.type === false">
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">发票类型：</div>
                    <div nz-col nzSpan="5">个人</div>
                    <div nz-col nzSpan="3" class="right_alignment">名称：</div>
                    <div nz-col nzSpan="5">{{data.invoiceName ? data.invoiceName : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">邮箱：</div>
                    <div nz-col nzSpan="5">{{data.email ? data.email : 'null'}}</div>
                  </div>
                  <div nz-row>
                    <div nz-col nzSpan="3" class="right_alignment">手机号：</div>
                    <div nz-col nzSpan="5">{{data.phone ? data.phone : 'null'}}</div>
                    <div nz-col nzSpan="3" class="right_alignment">是否默认：</div>
                    <div nz-col nzSpan="5">{{data.default === true ? '是' : data.default === false ? '否' : 'null'}}</div>
                  </div>
                </ng-container>

                <div nz-row class="invoice-line"></div>
              </ng-container>
            </div>
            <ng-template #userInfoCommonVisibleModalFooter>
              <button nz-button nzType="default" (click)="hideModal('UserCommon')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.latestLogin" nzWidth="750" nzTitle="登录详情" [nzFooter]="userLatestLoginAtModalFooter" (nzOnCancel)="hideModal('latestLoginAt')" nzMaskClosable="false">
            <nz-table nzBordered #rowLatestLoginTable [nzData]="latestLoginData" [nzSimple]="true" *ngIf="!isSpinning">
              <thead>
                <tr>
                  <th>序号</th>
                  <th>登录时间</th>
                  <th>登录地点</th>
                  <th>登录设备</th>
                  <th>登录的APP版本</th>
                  <th>登录的渠道</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of rowLatestLoginTable.data; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.loginTime}}</td>
                  <td>{{data.address}}</td>
                  <td>{{data.equipment}}</td>
                  <td>{{data.appVersion}}</td>
                  <td>{{data.appChannelId}}</td>
                </tr>
              </tbody>
            </nz-table>
            <ng-template #userLatestLoginAtModalFooter>
              <button nz-button nzType="default" (click)="hideModal('latestLoginAt')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="bookingHypostaticTemplate" (nzClick)="changePanel('bookingHypostatic')" *ngIf="commonService.haveMenuPermission('children', '实体订单管理')">
          <ng-template #bookingHypostaticTemplate><i class="anticon anticon-inbox"></i>实体服务订单</ng-template>
          <form [formGroup]="searchBookingForm">
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="3">
                <input nz-input [(ngModel)]="bookingPhone" formControlName="phone" placeholder="输入用户账号" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="channelType" placeholder="输入客户ID" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">订单类型：</div>
              <div nz-col nzSpan="2">
                <nz-select [(ngModel)]="bookingType" formControlName="type">
                  <nz-option [nzLabel]="'--全部--'" [nzValue]="''"></nz-option>
                  <nz-option required [nzLabel]="'机票'" [nzValue]="'1'"></nz-option>
                  <nz-option required [nzLabel]="'火车'" [nzValue]="'2'"></nz-option>
                  <nz-option required [nzLabel]="'酒店'" [nzValue]="'3'"></nz-option>
                  <nz-option required [nzLabel]="'打车'" [nzValue]="'4'"></nz-option>
                  <nz-option required [nzLabel]="'闪送'" [nzValue]="'8'"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">订单状态：</div>
              <div nz-col nzSpan="3">
                <nz-select [ngModel]="''" formControlName="status">
                  <nz-option [nzLabel]="'--全部--'" [nzValue]="''"></nz-option>
                  <nz-option required [nzValue]="'0'" [nzLabel]="'待支付'"></nz-option>
                  <nz-option required [nzValue]="'1'" [nzLabel]="bookingType === '3' ? '等待酒店确认' : bookingType === '4' ? '进行中' : bookingType === '8' ? '已接单' : '出票中'"></nz-option>
                  <nz-option required [nzValue]="'2'" [nzLabel]="bookingType === '4' ? '已接单' : bookingType === '8' ? '配送中' : '待出行'"></nz-option>
                  <nz-option required [nzValue]="'3'" [nzLabel]="bookingType === '4' ||  bookingType === '8' ? '已完成' : '已出行'"></nz-option>
                  <nz-option required [nzValue]="'4'" [nzLabel]="bookingType === '1' ||  bookingType === '2' ? '出票失败' : ''"></nz-option>
                  <nz-option required [nzValue]="'5'" [nzLabel]="'退款中'" *ngIf="bookingType === '1' || bookingType === '2' || bookingType === '3' || bookingType === '8'"></nz-option>
                  <nz-option required [nzValue]="'6'" [nzLabel]="bookingType === '8' ? '交易失败' : '已退款'" *ngIf="bookingType === '1' || bookingType === '2' || bookingType === '3' || bookingType === '8'"></nz-option>
                  <nz-option required [nzValue]="'7'" [nzLabel]="'已取消'"></nz-option>
                  <nz-option required [nzValue]="'8'" [nzLabel]="bookingType === '3' ? '预定失败' : bookingType === '8' ? '交易关闭' : '交易失败'"></nz-option>
                  <!-- <nz-option required [nzValue]="'9'" [nzLabel]="'改签中'"></nz-option> -->
                  <nz-option required [nzValue]="'10'" [nzLabel]="bookingType === '4' ? '呼叫中' : bookingType === '8' ? '等待接单' : '占座中'" *ngIf="bookingType === '2' || bookingType === '4' || bookingType === '8'"></nz-option>
                  <!-- <nz-option required [nzValue]="'11'" [nzLabel]="'取消中'"></nz-option> -->
                  <nz-option required [nzValue]="'12'" [nzLabel]="bookingType === '3' ? '退订中' : '退票中'" *ngIf="bookingType === '1' || bookingType === '2' || bookingType === '3'"></nz-option>
                  <nz-option required [nzValue]="'13'" [nzLabel]="bookingType === '3' ? '预定失败 退款中' : bookingType === '8' ? '交易失败 退款中' : '出票失败 退款中'" *ngIf="bookingType === '1' || bookingType === '2' || bookingType === '3' || bookingType === '8'"></nz-option>
                  <!-- <nz-option required [nzValue]="'14'" [nzLabel]="'退款失败'"></nz-option> -->
                  <nz-option required [nzValue]="'15'" [nzLabel]="bookingType === '4' ? '司机抵达' : '已到达寄件地址'" *ngIf="bookingType === '4' || bookingType === '8'"></nz-option>
                  <nz-option required [nzValue]="'16'" [nzLabel]="'已取消'" *ngIf="bookingType === '8'"></nz-option>
                </nz-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">订单编号：</div>
              <div nz-col nzSpan="3">
                <input nz-inputbookingOrderId [(ngModel)]="bookingOrderId" formControlName="orderId" placeholder="输入订单编号" nzSize="default"
                  style="padding: 4px 11px;height: 32px;color: rgba(0,0,0,.65);border: 1px solid #d9d9d9;border-radius: 4px;transition: all .3s;">
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="3" class="right_alignment">订单生成日期：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyy-MM-dd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'booking')"></nz-range-picker>
              </div>
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="doSearch('booking')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
          </form>

          <nz-table nzBordered #rowSelectionBookingTable [nzData]="dataOrder" [nzSimple]="true" [(nzPageSize)]="bookingPageSize" [nzShowPagination]="false" [nzScroll]="{x:'1800px'}">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户账号</th>
                <th>用户昵称</th>
                <th>客户ID</th>
                <th>订单状态</th>
                <th>订单类型</th>
                <th>订单生成日期</th>
                <th>订单价格</th>
                <th>支付方式</th>
                <th>内部订单号</th>
                <th>供应商订单号</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionBookingTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.account}}</td>
                <td>{{data.nickname}}</td>
                <td>{{data.channelType}}</td>
                <td>{{data.state === 0 ? '待支付' : data.state === 1 ? bookingType === '3' ? '等待酒店确认' : bookingType === '8' ? '已接单' : '出票中' : data.state === 2 ? bookingType === '4' ? '已接单' : bookingType === '8' ? '配送中' : '待出行' : data.state === 3 ? bookingType === '4' || bookingType === '8' ? '已完成' : '已出行' : data.state === 4 ? '出票失败' : data.state === 5 ? '退款中' : data.state === 6 ? bookingType === '8' ? '交易失败' : '已退款' : data.state === 7 ? '已取消' : data.state === 8 ? bookingType === '3' ? '预定失败' : '交易关闭' : data.state === 9 ? '改签中' : data.state === 10 ? bookingType === '4' ? '呼叫中' : bookingType === '8' ? '等待接单' : '占座中' : data.state === 11 ? '取消中' : data.state === 12 ? bookingType === '3' ? '退订中' : '退票中' : data.state === 13 ? bookingType === '3' ? '预订失败 退款中' : bookingType === '8' ? '交易失败 退款中' : '出票失败 退票中' : data.state === 14 ? '' : data.state === 15 ? bookingType === '4' ? '司机抵达' : '已到达寄件地址' : data.state === 16 ? '已取消' : 'null' }}</td>
                <td>{{data.orderType === 0 || data.orderType === 1 ? '机票' : data.orderType === 2 ? '火车' : data.orderType === 3 ? '酒店' : data.orderType === 4 ? '打车' : data.orderType === 8 ? '闪送' : 'null'}}</td>
                <td>{{data.createTime}}</td><!-- | date:'yy-MM-dd HH:mm:ss' -->
                <td>{{data.total}}</td>
                <td>{{data.paymentType === 1 ? '支付宝' : data.paymentType === 2 ? '微信' : data.paymentType === 3 ? (data.currencyTypeOfWallet === 1 ? '小悟币' : '小悟豆') : 'null' }}</td>
                <td>{{data.orderId}}</td>
                <td>{{data.actualId}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('BookingDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>订单详情</button>
                  <button nz-button nzType="primary" (click)="showModal('InvoiceDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>发票详情</button>
                  <!-- <button nz-button nzType="primary" *ngIf="data.state === 2 && (data.orderType === 0 || data.orderType === 1)" (click)="showModal('Refund', data)" style="margin-right: 10px;">退票</button> -->
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div nz-row style="margin: 10px 0;line-height: 30px;">
            <div nz-col nzSpan="12"></div>
            <div nz-col nzSpan="2">
              <nz-select [(ngModel)]="bookingPageSize">
                <nz-option required [nzLabel]="'5'" [nzValue]="5"></nz-option>
                <nz-option required [nzLabel]="'10'" [nzValue]="10"></nz-option>
                <nz-option required [nzLabel]="'20'" [nzValue]="20"></nz-option>
                <nz-option required [nzLabel]="'50'" [nzValue]="50"></nz-option>
              </nz-select>
            </div>
            <div nz-col nzSpan="1"><button [disabled]="changeBookingPage === 1 || totalBooking === 0" nz-button nzType="primary" (click)="lastPage('booking')"><i class="anticon anticon-left"></i></button></div>
            <div nz-col nzSpan="6">当前为 {{changeBookingPage}} / {{allBookingSize}} 页 &nbsp;&nbsp; 共 {{totalBooking}} 条</div>
            <div nz-col nzSpan="1"><button [disabled]="changeBookingPage === allBookingSize || totalBooking === 0" nz-button nzType="primary" (click)="nextPage('booking')"><i class="anticon anticon-right"></i></button></div>
          </div>
        </nz-tab>

        <nz-tab [nzTitle]="bookingDigitalTemplate" (nzClick)="changePanel('bookingDigital')" *ngIf="commonService.haveMenuPermission('children', '数字服务订单')">
          <ng-template #bookingDigitalTemplate><i class="anticon anticon-qrcode"></i>数字服务订单</ng-template>
          <form [formGroup]="searchBookingForm">
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="3">
                <input nz-input [(ngModel)]="bookingPhone" formControlName="phone" placeholder="输入用户账号" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="channelType" placeholder="输入客户ID" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">订单类型：</div>
              <div nz-col nzSpan="7">
                <nz-tree-select style="width: 250px" [nzDefaultExpandedKeys]="bookingTypeKeys"
                  [nzNodes]="bookingTypeNodes" nzShowSearch nzPlaceHolder="选择订单类型" formControlName="type"
                  [(ngModel)]="bookingType" (ngModelChange)="onChange($event)" ></nz-tree-select>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">订单编号：</div>
              <div nz-col nzSpan="3">
                <input nz-input [(ngModel)]="bookingOrderId" formControlName="orderId" placeholder="输入订单编号" nzSize="default" class="ant-input">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">订单状态：</div>
              <div nz-col nzSpan="3">
                <nz-select [ngModel]="''" formControlName="status">
                  <nz-option [nzLabel]="'--全部--'" [nzValue]="''"></nz-option>
                  <nz-option required [nzValue]="'0'" [nzLabel]="'待支付'" *ngIf="bookingType === '6' || bookingType === '7'"></nz-option>
                  <nz-option required [nzValue]="'1'" [nzLabel]="'充值中'" *ngIf="bookingType === '5'"></nz-option>
                  <nz-option required [nzValue]="'2'" [nzLabel]="'待放映'"></nz-option>
                  <nz-option required [nzValue]="'3'" [nzLabel]="'已完成'"></nz-option>
                  <!-- <nz-option required [nzValue]="'4'" [nzLabel]="'出票失败'"></nz-option> -->
                  <nz-option required [nzValue]="'5'" [nzLabel]="'充值失败 退款中'" *ngIf="bookingType === '5'"></nz-option>
                  <nz-option required [nzValue]="'6'" [nzLabel]="'已退款'" *ngIf="bookingType === '5'"></nz-option>
                  <nz-option required [nzValue]="'7'" [nzLabel]="'已取消'" *ngIf="bookingType === '6' || bookingType === '7'"></nz-option>
                  <nz-option required [nzValue]="'8'" [nzLabel]="'交易关闭'"></nz-option>
                  <!-- <nz-option required [nzValue]="'9'" [nzLabel]="'改签中'"></nz-option> -->
                  <!-- <nz-option required [nzValue]="'10'" [nzLabel]="'占座中'"></nz-option> -->
                  <!-- <nz-option required [nzValue]="'11'" [nzLabel]="'取消中'"></nz-option> -->
                  <!-- <nz-option required [nzValue]="'12'" [nzLabel]="'退票中'"></nz-option> -->
                  <nz-option required [nzValue]="'13'" [nzLabel]="'充值失败 退款中'" *ngIf="bookingType === '5'"></nz-option>
                  <!-- <nz-option required [nzLabel]="'退款失败'"></nz-option> -->
                  <!-- <nz-option required [nzLabel]="'司机抵达'"></nz-option> -->
                  <!-- <nz-option required [nzLabel]="'超时取消'"></nz-option> -->
                </nz-select>
              </div>
              <div nz-col nzSpan="3" class="right_alignment">订单生成日期：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyy-MM-dd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'booking')"></nz-range-picker>
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="doSearch('booking')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
          </form>

          <nz-table nzBordered #rowSelectionBooking2Table [nzData]="dataOrder" [nzSimple]="true" [(nzPageSize)]="bookingPageSize" [nzShowPagination]="false" [nzScroll]="{x:'1800px'}">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户账号</th>
                <th>用户昵称</th>
                <th>客户ID</th>
                <th>订单状态</th>
                <th>订单类型</th>
                <th>订单生成日期</th>
                <th>订单价格</th>
                <th>支付方式</th>
                <th>内部订单号</th>
                <th>供应商订单号</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionBooking2Table.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.account}}</td>
                <td>{{data.nickname}}</td>
                <td>{{data.channelType}}</td>
                <td>{{data.state === 0 ? '待支付' : data.state === 1 ? '充值中' :  data.state === 2 ? '待放映' : data.state === 3 ? '已完成' : data.state === 5 ? '充值失败 退款中' : data.state === 6 ? '已退款' : data.state === 7 ? '已取消' : data.state === 8 ? '交易关闭' : data.state === 13 ? '充值失败 退款中' : 'null' }}</td>
                <td>{{data.orderType === 5 ? '充话费' : data.orderType === 6 ? (data.flightType === 'APP_SINGLE' ? '快速脱单' : data.flightType === 'APP_COUPLE' ? '情侣合盘' : '恋爱运势') : data.orderType === 7 ? (data.flightType === 'APP_SUBSCRIPTION30' ? '30天运势' : data.flightType === 'APP_SUBSCRIPTION60' ? '60天运势' : data.flightType === 'APP_SUBSCRIPTION90' ? '90天运势' : '快速脱单') : data.orderType === 9 ? '电影票' : data.orderType === 10 ? (data.supplyType === 4 ? '口袋故事' : (data.supplyType === 5 ? '懒人听书' : '付费音频')) : 'null'}}</td>
                <td>{{data.createTime}}</td>
                <td>{{data.total}}</td>
                <td>{{data.paymentType === 1 ? '支付宝' : data.paymentType === 2 ? '微信' : data.paymentType === 3 ? (data.currencyTypeOfWallet === 1 ? '小悟币' : '小悟豆') : 'null' }}</td>
                <td>{{data.orderId}}</td>
                <td>{{data.actualId}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('BookingDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>订单详情</button>
                  <button nz-button nzType="primary" (click)="showModal('InvoiceDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>发票详情</button>
                  <!-- <button nz-button nzType="primary" *ngIf="data.state === 2 && (data.orderType === 0 || data.orderType === 1)" (click)="showModal('Refund', data)" style="margin-right: 10px;">退票</button> -->
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div nz-row style="margin: 10px 0;line-height: 30px;">
            <div nz-col nzSpan="12"></div>
            <div nz-col nzSpan="2">
              <nz-select [(ngModel)]="bookingPageSize">
                <nz-option required [nzLabel]="'5'" [nzValue]="5"></nz-option>
                <nz-option required [nzLabel]="'10'" [nzValue]="10"></nz-option>
                <nz-option required [nzLabel]="'20'" [nzValue]="20"></nz-option>
                <nz-option required [nzLabel]="'50'" [nzValue]="50"></nz-option>
              </nz-select>
            </div>
            <div nz-col nzSpan="1"><button [disabled]="changeBookingPage === 1 || totalBooking === 0" nz-button nzType="primary" (click)="lastPage('booking')"><i class="anticon anticon-left"></i></button></div>
            <div nz-col nzSpan="6">当前为 {{changeBookingPage}} / {{allBookingSize}} 页 &nbsp;&nbsp; 共 {{totalBooking}} 条</div>
            <div nz-col nzSpan="1"><button [disabled]="changeBookingPage === allBookingSize || totalBooking === 0" nz-button nzType="primary" (click)="nextPage('booking')"><i class="anticon anticon-right"></i></button></div>
          </div>
        </nz-tab>

        <nz-modal [(nzVisible)]="visiable.invoice" nzWidth="950" nzTitle="发票详情" [nzFooter]="invoiceDetailModalFooter" (nzOnCancel)="hideModal('InvoiceDetail')" nzMaskClosable="false">
          <div *ngIf="invoiceDetail.invoiceMsg">
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">发票状态：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.state === 0 ? '开票失败' : invoiceDetail.state === 1 ? '已开票' : invoiceDetail.state === 2 ? '开票中' : invoiceDetail.state === 3 ? '待开票' : invoiceDetail.state === 4 ? '发票作废' : 'null'}}</div>
              <div nz-col nzSpan="4" class="right_alignment">发票类型：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.type === 1 ? '企业' : invoiceDetail.type === 2 ? '个人' : 'null'}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开票金额：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoicePrice}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">公司名称：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.invoiceName}}</div>
              <div nz-col nzSpan="4" class="right_alignment">纳税人识别号：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.dutyParagraph}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">邮箱：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.email}}</div>
              <div nz-col nzSpan="4" class="right_alignment">手机号：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.phone}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">注册地址：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.registerAdd}}</div>
              <div nz-col nzSpan="4" class="right_alignment">注册电话：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.registerPhone}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开户银行：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.bank}}</div>
              <div nz-col nzSpan="4" class="right_alignment">开户账户：</div>
              <div nz-col nzSpan="8">{{invoiceDetail.invoiceMsg.account}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开票订单号：</div>
              <div nz-col nzSpan="8">
                <span *ngFor="let item of invoiceDetail.orderIds; let i=index;">
                  {{item}}<br>
                </span>
              </div>
            </div>
          </div>
          <div *ngIf="!invoiceDetail.invoiceMsg">
            <div nz-row>
              <div nz-col nzSpan="10"></div>
              <div nz-col nzSpan="4">暂无发票详情！</div>
              <div nz-col nzSpan="10"></div>
            </div>
          </div>
          <ng-template #invoiceDetailModalFooter>
            <button nz-button nzType="default" (click)="hideModal('InvoiceDetail')"><i class="anticon anticon-close-circle-o"></i>取消</button>
          </ng-template>
        </nz-modal>

        <nz-modal [(nzVisible)]="visiable.bookingDetail" nzWidth="750" nzTitle="订单详情" [nzFooter]="bookingDetailModalFooter" (nzOnCancel)="hideModal('BookingDetail')" nzMaskClosable="false">
          <div nz-row *ngIf="orderId && orderId !== ''"> <div nz-col nzSpan="5" class="right_alignment">订单id：</div> <div nz-col nzSpan="7">{{orderId}}</div> </div>
          <!-- 机票信息 -->
          <div *ngIf="isFlightOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">目的机场位置：</div> <div nz-col nzSpan="7">{{dataDetail.arr_airport}}</div> <div nz-col nzSpan="5" class="right_alignment">目的城市：</div> <div nz-col nzSpan="7">{{dataDetail.arr_city}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">到达时间：</div> <div nz-col nzSpan="7">{{dataDetail.arr_date}} {{dataDetail.arr_time}}</div> <div nz-col nzSpan="5" class="right_alignment">机票类型：</div> <div nz-col nzSpan="7">{{dataDetail.cabin_type}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">联系人：</div> <div nz-col nzSpan="7">{{dataDetail.contact}}</div> <div nz-col nzSpan="5" class="right_alignment">联系人电话：</div> <div nz-col nzSpan="7">{{dataDetail.contact_mobile}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">机场名称：</div> <div nz-col nzSpan="7">{{dataDetail.dept_airport}}</div> <div nz-col nzSpan="5" class="right_alignment">始发城市：</div> <div nz-col nzSpan="7">{{dataDetail.dept_city}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">始发时间：</div> <div nz-col nzSpan="7">{{dataDetail.dept_date}} {{dataDetail.dept_time}}</div> <div nz-col nzSpan="5" class="right_alignment">所在航班：</div> <div nz-col nzSpan="7">{{dataDetail.flight_com}}</div> </div>
            <div *ngFor="let item of dataDetail.flight_order_passengers; let i=index;" style="background-color: whitesmoke;">
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}姓名：</div> <div nz-col nzSpan="7">{{item.name}}</div> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}属性：</div> <div nz-col nzSpan="7">{{item.age_type}}</div> </div>
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}生日：</div> <div nz-col nzSpan="7">{{item.birthday}}</div> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}证件号：</div> <div nz-col nzSpan="7">{{item.card_no}}</div> </div>
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}性别：</div> <div nz-col nzSpan="7" *ngIf="item.sex === '1'">男</div> <div nz-col nzSpan="7" *ngIf="item.sex === '2'">女</div> </div>
            </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">旅程时间：</div> <div nz-col nzSpan="7">{{dataDetail.flight_times}}</div> <div nz-col nzSpan="5" class="right_alignment">航班类型：</div> <div nz-col nzSpan="7">{{dataDetail.flight_type}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">企业管家编号：</div> <div nz-col nzSpan="7"><a (click)="showExternal(1, orderId)">{{dataDetail.no}}</a></div> <div nz-col nzSpan="5" class="right_alignment">订单价格：</div> <div nz-col nzSpan="7">{{dataDetail.amount}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单类型：</div> <div nz-col nzSpan="7">{{dataDetail.order_type}}</div> <div nz-col nzSpan="5" class="right_alignment">备注：</div> <div nz-col nzSpan="7">{{dataDetail.remark}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">当前订单状态：</div> <div nz-col nzSpan="7">{{orderStatus === 0 ? '待支付' : orderStatus === 1 ? '出票中' : orderStatus === 2 ? '待出行' : orderStatus === 3 ? '已出行' : orderStatus === 4 ? '出票失败' : orderStatus === 5 ? '退款中' : orderStatus === 6 ? '已退款' : orderStatus === 7 ? '已取消' : orderStatus === 8 ? '交易失败' : orderStatus === 12 ? '退票中' : orderStatus === 13 ? '出票失败 退款中' : 'null' }}</div>
            <div nz-col nzSpan="5" class="right_alignment">退票原因：</div> <div nz-col nzSpan="7">{{dataDetail.refundDetailReason}}</div>
            </div>
          </div>

          <!-- 酒店信息 -->
          <div *ngIf="isHotelOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">到达时间：</div> <div nz-col nzSpan="7">{{dataDetail.arrival_date}}</div>  <div nz-col nzSpan="5" class="right_alignment">是否可取消：</div> <div nz-col nzSpan="7" *ngIf="dataDetail.cancel_policy.allowed === true">可以取消</div> <div nz-col nzSpan="7" *ngIf="dataDetail.cancel_policy.allowed === false">不可取消</div></div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">取消说明：</div> <div nz-col nzSpan="7">{{dataDetail.cancel_policy.penalty_type_name}}</div>  <div nz-col nzSpan="5" class="right_alignment">取消时限：</div> <div nz-col nzSpan="7">{{dataDetail.cancel_policy.time_limit}}</div></div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">手续费：</div> <div nz-col nzSpan="7">{{dataDetail.hotelOrderReturn.detail.penalty}}</div>  <div nz-col nzSpan="5" class="right_alignment">最晚到达时间：</div> <div nz-col nzSpan="7">{{dataDetail.cancel_policy.time_limit}}</div></div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">联系人电话：</div> <div nz-col nzSpan="7">{{dataDetail.contact_mobile}}</div>  <div nz-col nzSpan="5" class="right_alignment">联系人姓名：</div> <div nz-col nzSpan="7">{{dataDetail.contact_name}}</div></div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单创建时间：</div> <div nz-col nzSpan="7">{{dataDetail.createAt}}</div> </div>
            <div *ngFor="let item of dataDetail.customers; let i=index;" style="background-color: whitesmoke;">
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">入住成员{{i}}：</div> <div nz-col nzSpan="7">{{item.name}}</div> </div>
            </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">离开时间：</div> <div nz-col nzSpan="7">{{dataDetail.departure_date}}</div> <div nz-col nzSpan="5" class="right_alignment">订单价格：</div> <div nz-col nzSpan="7">{{dataDetail.hotelOrderReturn.order_amount}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">酒店订单编号：</div> <div nz-col nzSpan="7"><a (click)="showExternal(3, orderId)">{{dataDetail.hotelOrderReturn.no}}</a></div> <div nz-col nzSpan="5" class="right_alignment">酒店订单状态：</div> <div nz-col nzSpan="7">{{dataDetail.hotelOrderReturn.state_name}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">酒店订单创建时间：</div> <div nz-col nzSpan="7">{{dataDetail.hotelOrderReturn.created_at}}</div> <div nz-col nzSpan="5" class="right_alignment">酒店所在城市：</div> <div nz-col nzSpan="7">{{dataDetail.hotel_city}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">酒店编号：</div> <div nz-col nzSpan="7">{{dataDetail.hotel_id}}</div> <div nz-col nzSpan="5" class="right_alignment">酒店名称：</div> <div nz-col nzSpan="7">{{dataDetail.hotel_name}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">酒店评价：</div> <div nz-col nzSpan="7">{{dataDetail.hotel_score}}分</div> <div nz-col nzSpan="5" class="right_alignment">最晚到达时间：</div> <div nz-col nzSpan="7">{{dataDetail.latest_arrival_time}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">房间类型：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.bed_type}}</div> <div nz-col nzSpan="5" class="right_alignment">房间容纳人数：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.capacity}}人</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">房间小孩人数：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.children}}人</div> <div nz-col nzSpan="5" class="right_alignment">房间是否有早餐：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.meal}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">房间规格：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.rate_type_name}}</div> <div nz-col nzSpan="5" class="right_alignment">房间占地面积：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.roomArea}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">房间特色：</div> <div nz-col nzSpan="7">{{dataDetail.order_room.room_type_name}}</div> <div nz-col nzSpan="5" class="right_alignment">预订房间数量：</div> <div nz-col nzSpan="7">{{dataDetail.room_nums}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">信息来源：</div> <div nz-col nzSpan="7">{{dataDetail.source}}</div> <div nz-col nzSpan="5" class="right_alignment">酒店星级：</div> <div nz-col nzSpan="7">{{dataDetail.stars_level}}星级</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">用户Id：</div> <div nz-col nzSpan="7">{{dataDetail.userId}}</div> <div nz-col nzSpan="5" class="right_alignment">当前订单状态：</div> <div nz-col nzSpan="7">{{orderStatus === 0 ? '待支付' : orderStatus === 1 ? '等待酒店确认' : orderStatus === 2 ? '待出行' : orderStatus === 3 ? '已出行' : orderStatus === 5 ? '退款中' : orderStatus === 6 ? '已退款' : orderStatus === 7 ? '已取消' : orderStatus === 8 ? '预定失败' : orderStatus === 12 ? '退订中' : orderStatus === 13 ? '预订失败 退款中' : 'null' }}</div> </div>
          </div>

          <!-- 火车信息 -->
          <div *ngIf="isTrainOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单创建时间：</div> <div nz-col nzSpan="7">{{dataDetail.created_at}}</div> <div nz-col nzSpan="5" class="right_alignment">订单编号：</div> <div nz-col nzSpan="7"><a (click)="showExternal(2, orderId)">{{dataDetail.no}}</a></div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">到达时间：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.arrival_at}}</div> <div nz-col nzSpan="5" class="right_alignment">到达城市：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.arrival_city_name}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">变更差价：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.change_price_diff}}</div> <div nz-col nzSpan="5" class="right_alignment">变更服务价格：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.change_service_charge}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">联系人电话：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.contact_mobile}}</div> <div nz-col nzSpan="5" class="right_alignment">联系人姓名：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.contacts}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">出发时间：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.departure_at}}</div> <div nz-col nzSpan="5" class="right_alignment">出发城市：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.departure_city_name}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">出发站台：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.from_station}}</div> <div nz-col nzSpan="5" class="right_alignment">到达站台：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.to_station}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">火车编号：</div> <div nz-col nzSpan="7">{{dataDetail.service_order.train_no}}</div> </div>
            <div *ngFor="let item of dataDetail.service_order.tickets; let i=index;" style="background-color: whitesmoke;">
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}退款价：</div> <div nz-col nzSpan="7">{{item.estimate_refund_price}}</div> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}变更价格：</div> <div nz-col nzSpan="7">{{item.estimate_refund_service_charge}}</div> </div>
              <div nz-row> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}编号：</div>
                <div nz-col nzSpan="7">{{item.id}}</div> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}价格：</div> <div nz-col nzSpan="7">{{item.price}}</div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}退款费用：</div> <div nz-col nzSpan="7" *ngIf="item.refund_price">{{item.refund_price}}</div> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}退款服务费：</div> <div nz-col nzSpan="7">{{item.refund_service_charge}}</div> </div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}座位类型：</div> <div nz-col nzSpan="7">{{item.seat_category}}</div> <div nz-col nzSpan="5" class="right_alignment">车票{{i+1}}状态：</div> <div nz-col nzSpan="7">{{item.state_name}}</div> </div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}生日：</div> <div nz-col nzSpan="7">{{item.passenger.birthday}}</div> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}编号：</div> <div nz-col nzSpan="7">{{item.passenger.id_no}}</div> </div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}身份证：</div> <div nz-col nzSpan="7">{{item.passenger.id_type_name}}</div> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}姓名：</div> <div nz-col nzSpan="7">{{item.passenger.name}}</div> </div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}类型：</div> <div nz-col nzSpan="7">{{item.passenger.id_type}}</div> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}是否退款：</div> <div nz-col nzSpan="7">{{item.passenger.refund === true ? '是' : '否'}}</div> </div>
                <div nz-row> <div nz-col nzSpan="5" class="right_alignment">乘客{{i+1}}性别：</div> <div nz-col nzSpan="7">{{item.passenger.sex}}</div> </div>
              </div>
            </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单情况：</div> <div nz-col nzSpan="7">{{dataDetail.state_name}}</div> <div nz-col nzSpan="5" class="right_alignment">当前订单状态：</div> <div nz-col nzSpan="7">{{orderStatus === 0 ? '待支付' : orderStatus === 1 ? '出票中' : orderStatus === 2 ? '待出行' : orderStatus === 3 ? '已出行' : orderStatus === 4 ? '出票失败' : orderStatus === 5 ? '退款中' : orderStatus === 6 ? '已退款' : orderStatus === 7 ? '已取消' : orderStatus === 8 ? '交易关闭' : orderStatus === 10 ? '占座中' : orderStatus === 13 ? '出票失败 退款中' : 'null' }}</div> </div>
          </div>

          <!-- 打车信息 -->
          <div *ngIf="isTaxiOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单状态：</div> <div nz-col nzSpan="7">{{orderStatus === 0 ? '待支付' : orderStatus === 1 ? '出票中' : orderStatus === 2 ? '已接单' : orderStatus === 3 ? '已完成' : orderStatus === 7 ? '已取消' : orderStatus === 8 ? '交易关闭' : orderStatus === 10 ? '呼叫中' : orderStatus === 15 ? '司机抵达' : 'null' }}</div> <div nz-col nzSpan="5" class="right_alignment">订单生成时间：</div> <div nz-col nzSpan="7">{{dataDetail.createTime}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">预估价格：</div> <div nz-col nzSpan="7">{{dataDetail.estimatePrice}}</div> <div nz-col nzSpan="5" class="right_alignment">内部订单号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">出发地：</div> <div nz-col nzSpan="7">{{dataDetail.deptAdd}}</div> <div nz-col nzSpan="5" class="right_alignment">目的地：</div> <div nz-col nzSpan="7">{{dataDetail.arrAdd}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">用户账号：</div> <div nz-col nzSpan="7">{{dataDetail.userPhone}}</div> <div nz-col nzSpan="5" class="right_alignment">用户昵称：</div> <div nz-col nzSpan="7">{{dataDetail.userName}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">打车平台：</div> <div nz-col nzSpan="7">{{dataDetail.source}}</div> <div nz-col nzSpan="5" class="right_alignment">司机电话：</div> <div nz-col nzSpan="7">{{dataDetail.driverPhone}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">车牌号码：</div> <div nz-col nzSpan="7">{{dataDetail.carNo}}</div> <div nz-col nzSpan="5" class="right_alignment">订单类型：</div> <div nz-col nzSpan="7">{{dataDetail.orderType}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">出行时间：</div> <div nz-col nzSpan="7">{{dataDetail.startTime}}</div> <div nz-col nzSpan="5" class="right_alignment">实付价格：</div> <div nz-col nzSpan="7">{{dataDetail.paymentPrice}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">平台订单号：</div> <div nz-col nzSpan="7">{{dataDetail.sourceId}}</div> <div nz-col nzSpan="5" class="right_alignment">供应商订单号：</div> <div nz-col nzSpan="7">{{dataDetail.actualId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">评价时间：</div> <div nz-col nzSpan="7">{{dataDetail.commentTime}}</div></div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单评价：</div> <div nz-col nzSpan="7">{{dataDetail.score}}</div> <div nz-col nzSpan="5" class="right_alignment">其他建议：</div> <div nz-col nzSpan="7">{{dataDetail.comment}}</div> </div>
          </div>

          <!-- 闪送信息 -->
          <div *ngIf="isDeliveryOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单编号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> <div nz-col nzSpan="5" class="right_alignment">订单状态：</div> <div nz-col nzSpan="7">{{dataDetail.state === 0 ? '待支付' : dataDetail.state === 1 ? '已接单' : dataDetail.state === 2 ? '配送中' : dataDetail.state === 3 ? '已完成' : dataDetail.state === 5 ? '退款中' : dataDetail.state === 6 ? '交易失败' : dataDetail.state === 7 ? '已取消' : dataDetail.state === 8 ? '交易关闭' : dataDetail.state === 10 ? '等待接单' : dataDetail.state === 13 ? '交易失败 退款中' : dataDetail.state === 15 ? '已到达寄件地址' : dataDetail.state === 16 ? '已取消' : 'null'}}</div> </div>
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单状态描述：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">付款方式：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">付款方式描述：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">付款状态：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">付款金额：</div> <div nz-col nzSpan="7">{{dataDetail.amount}}</div> <div nz-col nzSpan="5" class="right_alignment">订单创建时间：</div> <div nz-col nzSpan="7">{{dataDetail.createTime}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">业务信息：</div> <div nz-col nzSpan="7">{{dataDetail.content}}</div> <div nz-col nzSpan="5" class="right_alignment">订单失败原因：</div> <div nz-col nzSpan="7">{{dataDetail.failureReason}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">寄件人姓名：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.sender.name}}</div> <div nz-col nzSpan="5" class="right_alignment">寄件人手机：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.sender.mobile}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">寄件城市：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.sender.city}}</div> <div nz-col nzSpan="5" class="right_alignment">寄件地址：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.sender.address}}</div> </div>
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">寄件经度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">寄件纬度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">收件人姓名：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.receiver.name}}</div> <div nz-col nzSpan="5" class="right_alignment">收件人手机：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.receiver.mobile}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">收件城市：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.receiver.city}}</div> <div nz-col nzSpan="5" class="right_alignment">收件地址：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.receiver.address}}</div> </div>
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">收件经度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">收件纬度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">物品名称：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.goods}}</div> <div nz-col nzSpan="5" class="right_alignment">物品重量：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.weight}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">加价金额：</div> <div nz-col nzSpan="7">{{dataDetail.createExpressOrder.addition}}</div> </div>
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">预约上门取件时间：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">取消费用：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">闪送员姓名：</div> <div nz-col nzSpan="7">{{dataDetail.courier}}</div> <div nz-col nzSpan="5" class="right_alignment">闪送员电话：</div> <div nz-col nzSpan="7">{{dataDetail.courierMobile}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">取件密码：</div> <div nz-col nzSpan="7">{{dataDetail.password}}</div> </div>
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">闪送员轨迹信息：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">闪送员所在纬度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">闪送员所在经度：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">闪送员所在位置的时间：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
            <!-- <div nz-row> <div nz-col nzSpan="5" class="right_alignment">备注信息：</div> <div nz-col nzSpan="7">{{dataDetail.aaaaaa}}</div> </div> -->
          </div>

          <!-- 充话费信息 -->
          <div *ngIf="isPhoneBillOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">要充值的手机号：</div> <div nz-col nzSpan="7">{{dataDetail.createOrder.phoneNumber}}</div> <div nz-col nzSpan="5" class="right_alignment">充值金额：</div> <div nz-col nzSpan="7">{{dataDetail.createOrder.price}}元</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">商家订单号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> <div nz-col nzSpan="5" class="right_alignment">订单号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">总金额：</div> <div nz-col nzSpan="7">{{dataDetail.createOrder.price}}元</div> <div nz-col nzSpan="5" class="right_alignment">充值状态：</div> <div nz-col nzSpan="7">{{dataDetail.state === 1 ? '已接单' : dataDetail.state === 3 ? '已完成' : dataDetail.state === 5 ? '充值失败 退款中' : dataDetail.state === 6 ? '已退款' : dataDetail.state === 8 ? '交易关闭' : dataDetail.state === 13 ? '充值失败 退款中' : 'null'}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单生成时间：</div> <div nz-col nzSpan="7">{{dataDetail.createTime}}</div> </div>
          </div>

          <!-- 星座订单信息 -->
          <div *ngIf="isConstellationOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单编号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> <div nz-col nzSpan="5" class="right_alignment">订单类型：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders ? '恋爱运势' : (dataDetail.createFortuneOrder.fortuneType.value === '30' ? '30天运势' : dataDetail.createFortuneOrder.fortuneType.value === '60' ? '60天运势' : dataDetail.createFortuneOrder.fortuneType.value === '70' ? '70天运势' : '快速脱单')}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单价格：</div> <div nz-col nzSpan="7">{{dataDetail.amount}}元</div> <div nz-col nzSpan="5" class="right_alignment">订单生成时间：</div> <div nz-col nzSpan="7">{{dataDetail.createTime}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单状态：</div> <div nz-col nzSpan="7">{{dataDetail.state === 0 ? '待支付' : dataDetail.state === 3 ? '已完成' : dataDetail.state === 7 ? '已取消' : dataDetail.state === 8 ? '交易关闭' : 'null'}}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">出生日期1：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[0] ? dataDetail.createPairOrders[0].birth : 'null'}}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder && dataDetail.createPairOrders[1]"> <div nz-col nzSpan="5" class="right_alignment">出生日期2：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[1] ? dataDetail.createPairOrders[1].birth : 'null'}}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder && dataDetail.createPairOrders[1]"> <div nz-col nzSpan="5" class="right_alignment">性别1：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[1] ? (dataDetail.createPairOrders[1].gender === 0 ? '女' : '男') : 'null' }}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder && dataDetail.createPairOrders[1]"> <div nz-col nzSpan="5" class="right_alignment">性别2：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[1] ? (dataDetail.createPairOrders[1].gender === 0 ? '女' : '男') : 'null' }}</div> </div>
            <div nz-row *ngIf="dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">性别：</div> <div nz-col nzSpan="7">{{dataDetail.createFortuneOrder.gender === '0' ? '女' : '男' }}</div> </div>
            <div nz-row *ngIf="dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">所在城市：</div> <div nz-col nzSpan="7">{{dataDetail.createFortuneOrder.birthLocation1}} {{dataDetail.createFortuneOrder.birthLocation2}}</div> </div>
            <div nz-row *ngIf="dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">现居地：</div> <div nz-col nzSpan="7">{{dataDetail.createFortuneOrder.birthLocation2}}</div> </div>
            <div nz-row *ngIf="dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">开始日期：</div> <div nz-col nzSpan="7">{{dataDetail.startDate}}</div> </div>
            <div nz-row *ngIf="dataDetail.createFortuneOrder"> <div nz-col nzSpan="5" class="right_alignment">结束日期：</div> <div nz-col nzSpan="7">{{dataDetail.endDate}}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder && dataDetail.createPairOrders[1]"> <div nz-col nzSpan="5" class="right_alignment">角色1：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[1] ? dataDetail.createPairOrders[1].birth : 'null'}}</div> </div>
            <div nz-row *ngIf="!dataDetail.createFortuneOrder && dataDetail.createPairOrders[1]"> <div nz-col nzSpan="5" class="right_alignment">角色2：</div> <div nz-col nzSpan="7">{{dataDetail.createPairOrders[1] ? dataDetail.createPairOrders[1].birth : 'null'}}</div> </div>
          </div>

          <!-- 星座订单信息 -->
          <div *ngIf="isMovieOrder">
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">订单编号：</div> <div nz-col nzSpan="7">{{dataDetail.actualId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">订单类型：</div> <div nz-col nzSpan="9">电影票</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">影院名称：</div> <div nz-col nzSpan="9">{{dataDetail.cinemaName}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">影片信息：</div> <div nz-col nzSpan="9">{{dataDetail.movieName}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">影厅信息：</div> <div nz-col nzSpan="9">{{dataDetail.startTime}} -- {{dataDetail.endTime}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">用户手机号：</div> <div nz-col nzSpan="9">{{dataDetail.userPhone}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">座位信息：</div> <div nz-col nzSpan="9">
              {{dataDetail.seat[0] ? '【' + dataDetail.seat[0].row + '行' : ''}} {{dataDetail.seat[0] ? dataDetail.seat[0].col + '列】' : ''}}
              {{dataDetail.seat[1] ? '【' + dataDetail.seat[1].row + '行' : ''}} {{dataDetail.seat[1] ? dataDetail.seat[1].col + '列】' : ''}}
              {{dataDetail.seat[2] ? '【' + dataDetail.seat[2].row + '行' : ''}} {{dataDetail.seat[2] ? dataDetail.seat[2].col + '列】' : ''}}
              {{dataDetail.seat[3] ? '【' + dataDetail.seat[3].row + '行' : ''}} {{dataDetail.seat[3] ? dataDetail.seat[3].col + '列】' : ''}}
            </div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">总价：</div> <div nz-col nzSpan="9">{{dataDetail.amount}}元</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">下单时间：</div> <div nz-col nzSpan="9">{{dataDetail.createTime}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">订单状态：</div> <div nz-col nzSpan="9">{{dataDetail.state === 0 ? '待支付' : dataDetail.state === 3 ? '出票中' : dataDetail.state === 7 ? '出票失败' : dataDetail.state === 8 ? '待放映' : dataDetail.state === 8 ? '已放映' : 'null'}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">取票序列号：</div> <div nz-col nzSpan="9">
              {{dataDetail.front ? dataDetail.front[0] && dataDetail.front[0].text ? dataDetail.front[0].text === '序号' ? dataDetail.front[0].value : '' : '' : ''}}
              {{dataDetail.front ? dataDetail.front[1] && dataDetail.front[1].text ? dataDetail.front[1].text === '序号' ? dataDetail.front[1].value : '' : '' : ''}}
            </div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">取票验证码：</div> <div nz-col nzSpan="9">
              {{dataDetail.front ? dataDetail.front[0] && dataDetail.front[0].text ? dataDetail.front[0].text === '验票码' ? dataDetail.front[0].value : '' : '' : ''}}
              {{dataDetail.front ? dataDetail.front[1] && dataDetail.front[1].text ? dataDetail.front[1].text === '验票码' ? dataDetail.front[1].value : '' : '' : ''}}
              {{dataDetail.front ? dataDetail.front[0] && dataDetail.front[0].text ? dataDetail.front[0].text === '取票码' ? dataDetail.front[0].value : '' : '' : ''}}
              {{dataDetail.front ? dataDetail.front[1] && dataDetail.front[1].text ? dataDetail.front[1].text === '取票码' ? dataDetail.front[1].value : '' : '' : ''}}
            </div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">取票方式：</div> <div nz-col nzSpan="9">
              {{dataDetail.twoDimenCode !== '' ? '二维码取票' : ''}}&nbsp;
              {{dataDetail.front ? dataDetail.front.length > 0 ? '前台取票取票' : '' : ''}}&nbsp;
              {{dataDetail.third ? dataDetail.third.length > 0 ? '第三方取票机取票' : '' : ''}}&nbsp;
              {{dataDetail.nuoMi ? dataDetail.nuoMi.length > 0 ? '糯米自助取票机取票' : '' : ''}}&nbsp;
              {{dataDetail.common ? dataDetail.common.length > 0 ? '糯米通取机取票' : '' : ''}}&nbsp;
            </div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">糯米取票机取票：</div> <div nz-col nzSpan="9">{{dataDetail.nuoMi}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">糯米通取票机：</div> <div nz-col nzSpan="9">{{dataDetail.common}}</div> </div>
            <div nz-row> <div nz-col nzSpan="11" class="right_alignment">二维码取票：</div> <div nz-col nzSpan="9">{{dataDetail.twoDimenCode}}</div> </div>
          </div>

          <!-- 付费音频订单信息 -->
          <div *ngIf="isPayMusicOrder">
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">用户账号：</div> <div nz-col nzSpan="7">{{dataDetail.contactPhone}}</div> <div nz-col nzSpan="5" class="right_alignment">用户昵称：</div> <div nz-col nzSpan="7">{{dataDetail.nickname}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">供应商订单号：</div> <div nz-col nzSpan="7">{{dataDetail.actualId}}</div> <div nz-col nzSpan="5" class="right_alignment">内部订单号：</div> <div nz-col nzSpan="7">{{dataDetail.orderId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单创建时间：</div> <div nz-col nzSpan="7">{{dataDetail.createTime}}</div> <div nz-col nzSpan="5" class="right_alignment">订单支付时间：</div> <div nz-col nzSpan="7">{{dataDetail.paymentTimestamp | date:'yyyy-MM-dd'}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单金额：</div> <div nz-col nzSpan="7">{{dataDetail.amount}}元</div> <div nz-col nzSpan="5" class="right_alignment">订单状态：</div> <div nz-col nzSpan="7">{{dataDetail.state === 0 ? '待支付' : dataDetail.state === 3 ? '已完成' : dataDetail.state === 7 ? '已取消' : dataDetail.state === 8 ? '交易关闭' : 'null'}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">订单类型：</div> <div nz-col nzSpan="7">付费音频</div> <div nz-col nzSpan="5" class="right_alignment">供应商：</div> <div nz-col nzSpan="7">{{(dataDetail.sourceType.index === 4 ? '口袋故事' : (dataDetail.sourceType.index === 5 ? '懒人听书' : '付费音频'))}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">购买方式：</div> <div nz-col nzSpan="7">{{dataDetail.actualId}}</div> <div nz-col nzSpan="5" class="right_alignment">音频id：</div> <div nz-col nzSpan="7">{{dataDetail.goodsId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">音频名称：</div> <div nz-col nzSpan="7">{{dataDetail.workName}}</div> <div nz-col nzSpan="5" class="right_alignment">音频子id：</div> <div nz-col nzSpan="7">{{dataDetail.goodsResId}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">音频集数：</div> <div nz-col nzSpan="7">{{dataDetail.allEpisodes}}</div> <div nz-col nzSpan="5" class="right_alignment">起始集数：</div> <div nz-col nzSpan="7">{{dataDetail.startEpisode}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">结束集数：</div> <div nz-col nzSpan="7">{{dataDetail.endEpisode}}</div> <div nz-col nzSpan="5" class="right_alignment">单价：</div> <div nz-col nzSpan="7">{{dataDetail.originalFee}}</div> </div>
            <div nz-row> <div nz-col nzSpan="5" class="right_alignment">购买数量：</div> <div nz-col nzSpan="7">{{dataDetail.quantity}}</div> </div>
          </div>

          <ng-template #bookingDetailModalFooter>
            <button *ngIf="isHotelOrder && orderStatus===2" nz-button nzType="primary" (click)="cancleHotelOrder()"><i class="anticon anticon-close-circle-o"></i>取消订单</button>
            <button nz-button nzType="default" (click)="hideModal('BookingDetail')"><i class="anticon anticon-close-circle-o"></i>取消</button>
          </ng-template>
        </nz-modal>

        <nz-modal [(nzVisible)]="visiable.refund" nzWidth="950" nzTitle="退票申请" [nzFooter]="refundModalFooter" (nzOnCancel)="hideModal('Refund')" nzMaskClosable="false">
          <div nz-row>
            <div nz-col nzSpan="24">选择退票机票</div>
          </div>
          <div nz-row *ngFor="let data of dataRefund; let i=index;">
            <div nz-col nzSpan="1">
              <nz-radio-group [(ngModel)]="refundRadio">
                <label nz-radio [nzValue]="data.passengerName"></label>
              </nz-radio-group>
            </div>
            <div nz-col nzSpan="2" style="font-weight: bold;">乘客{{i+1}}</div>
            <div nz-col nzSpan="2">{{data.passengerName}}</div>
            <div nz-col nzSpan="2" style="font-weight: bold;">证件号{{i+1}}</div>
            <div nz-col nzSpan="7">{{data.cardNum}}</div>
            <div nz-col nzSpan="2" style="font-weight: bold;">退票原因</div>
            <div nz-col nzSpan="8">
              <nz-select [ngModel]="data.msg" (ngModelChange)="onRefundMsgChange($event, i)">
                <nz-option required *ngFor="let item of data.msg; let i=index;" [nzLabel]="item" [nzValue]="item"></nz-option>
              </nz-select>
            </div>
          </div>
          <!-- 弹框和底部定制 -->
          <ng-template #refundModalFooter>
            <button nz-button nzType="primary" (click)="doDelete('Refund')">提交</button>
            <button nz-button nzType="default" (click)="hideModal('Refund')"><i class="anticon anticon-close-circle-o"></i>取消</button>
          </ng-template>
        </nz-modal>

        <nz-tab [nzTitle]="adjustTemplate" (nzClick)="changePanel('adjust')" *ngIf="commonService.haveMenuPermission('children', '数据调整')">
          <ng-template #adjustTemplate><i class="anticon anticon-calculator"></i>数据调整</ng-template>
          <div nz-row>
            <div nz-col nzSpan="3" class="right_alignment">操作时间：</div>
            <div nz-col nzSpan="7">
              <nz-range-picker [nzFormat]="'yyyyMMdd'" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'adjust')"></nz-range-picker>
            </div>
            <div nz-col nzSpan="3" class="right_alignment">货币类型：</div>
            <div nz-col nzSpan="4">
              <nz-select [(ngModel)]="adjustType">
                <nz-option required [nzLabel]="'---全部---'" nzValue="ALL"></nz-option>
                <nz-option required [nzLabel]="'小悟豆'" nzValue="BEAN"></nz-option>
                <nz-option required [nzLabel]="'小悟币'" nzValue="COIN"></nz-option>
              </nz-select>
            </div>
            <div nz-col nzSpan="2"></div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('adjust')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showModal('adjustAdd', '')"><i class="anticon anticon-file-add"></i>新增发放</button>
            </div>
          </div>

          <nz-table nzBordered #rowAdjustDataTable [nzData]="adjustData" [nzSimple]="true">
            <thead>
              <tr>
                <th>序号</th>
                <th>发放日期</th>
                <th>发放时间</th>
                <th>发放人数</th>
                <th>失败人数</th>
                <th>货币类型</th>
                <!-- <th>数量</th> -->
                <th>调整原因</th>
                <th>操作人</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowAdjustDataTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.createDate | date:'yyyy-MM-dd' }}</td>
                <td>{{data.createTime}}</td>
                <td>{{data.all}}</td>
                <td>{{data.failNum}}</td>
                <td>{{data.adjustType === 'BEAN' ? '小悟豆' : data.adjustType === 'COIN' ? '小悟币' : 'null'}}</td>
                <!-- <td>{{data.adjustAmount}}</td> -->
                <td nzTitle="{{data.adjustReason}}" nzPlacement="bottom" nz-tooltip><a>详细原因</a></td>
                <td>{{data.operater.phone}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('adjustDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>查看</button>
                </td>
              </tr>
            </tbody>
          </nz-table>

          <nz-modal [(nzVisible)]="visiable.adjustAdd" nzWidth="950" nzTitle="新增发放" [nzFooter]="adjustAddModalFooter" (nzOnCancel)="hideModal('adjustAdd')" nzMaskClosable="false">
            <form [formGroup]="addAdjustForm">
              <div nz-row>
                <div nz-col nzSpan="3" style="font-size: 20px;font-weight: bold;">发送对象</div>
                <div nz-col nzSpan="20" style="color: #a9a9a9">
                  请填写发送的用户id（手机号码），如果需要发送多个，请换行输入<br>
                  单次发送人数上限：10000（如果需要调整，请通知产品）<br>
                  正数为增加，负数为减少；若减少的金额大于用户余额，则调整失败
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3"></div>
                <div nz-col nzSpan="21">
                  <nz-radio-group [(ngModel)]="adjustTypeAdd" formControlName="adjustType">
                    <div nz-row>
                      <div nz-col nzSpan="4"><label nz-radio nzValue="BEAN">小悟豆</label></div>
                      <div nz-col nzSpan="10"></div>
                      <div nz-col nzSpan="4"><label nz-radio nzValue="COIN">小悟币</label></div>
                    </div>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3"></div>
                <div nz-col nzSpan="12">
                  <textarea rows="5" nz-input formControlName="users" [(ngModel)]="adjustDetail.users"
                    placeholder="请输入手机号以及对应的奖励，通过逗号','隔开【发放对象手机号码】以及【发放奖励数量】" nzSize="default"></textarea>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3"></div>
                <div nz-col nzSpan="4">
                  <a href="javascript:;" class="a-upload"><i class="anticon anticon-upload"></i>上传文件
                    <input type="file" (change)="getExcel($event)" multiple="false" />
                  </a>
                </div>
                <div nz-col nzSpan="6" style="margin-top: 15px;">支持.CSV，.xls，.xlsx</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" style="font-size: 20px;font-weight: bold;">附带消息</div>
                <div nz-col nzSpan="20" style="color: #a9a9a9">
                  一般适用于奖励/补偿用户，附带的信息
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" class="right_alignment">标题：</div>
                <div nz-col nzSpan="9">
                  <input nz-input nzSize="default" formControlName="noticeTitle" [(ngModel)]="adjustDetail.noticeTitle" placeholder="请输入标题">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" class="right_alignment">类型：</div>
                <div nz-col nzSpan="9">系统消息</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" class="right_alignment">摘要：</div>
                <div nz-col nzSpan="9">
                  <input nz-input nzSize="default" formControlName="noticeAbstract" [(ngModel)]="adjustDetail.noticeAbstract" placeholder="请输入摘要">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" class="right_alignment">内容：</div>
                <div nz-col nzSpan="20">
                  <quill-editor formControlName="noticeContent" [(ngModel)]="adjustDetail.noticeContent" [modules]="commonService.config" [style]="{height: '300px'}"></quill-editor>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3" style="font-size: 20px;font-weight: bold;">调整原因</div>
                <div nz-col nzSpan="20" style="color: #a9a9a9">
                  调整原因，是为了后面追溯的时候，能够追溯到为什么有这个操作，也方便归因
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="3"></div>
                <div nz-col nzSpan="12">
                  <textarea rows="5" nz-input formControlName="adjustReason" [(ngModel)]="adjustDetail.adjustReason" placeholder="请输入调整原因" nzSize="default"></textarea>
                </div>
              </div>
            </form>
            <ng-template #adjustAddModalFooter>
              <button nz-button nzType="primary" (click)="showModal('adjustSend')"><i class="anticon anticon-save"></i>确定</button>
              <button nz-button nzType="default" (click)="hideModal('adjustAdd')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.adjustSend" nzWidth="750" nzTitle="执行发送" [nzFooter]="adjustSendModalFooter" (nzOnCancel)="hideModal('adjustSend')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="7" class="spthumbnailan_down">发送对象（总计x个）</div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="7" class="spthumbnailan_down">奖励配置</div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="7" class="spthumbnailan_down">附带消息</div>
              <div nz-col nzSpan="1"></div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="7">
                <textarea rows="5" nz-input [(ngModel)]="adjustSendData.users" [disabled]="true" nzSize="default"></textarea>
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="7">
                <textarea rows="5" nz-input [(ngModel)]="adjustSendData.config" [disabled]="true" zSize="default"></textarea>
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="7">
                <textarea rows="5" nz-input [(ngModel)]="adjustSendData.noticeContent" [disabled]="true" zSize="default"></textarea>
              </div>
              <div nz-col nzSpan="1"></div>
            </div>

            <div nz-row>
              <div nz-col nzSpan="4">
                <nz-select [(ngModel)]="operateObject.operater">
                  <nz-option required *ngFor="let data of operatersData; let i=index;" [nzLabel]="data" [nzValue]="data"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="3">
                <button nz-button nzType="primary" (click)="doSave('sendMsg')" [disabled]="semdMesCodeText !== 60">{{semdMesCodeText === 60 ? '验证' : semdMesCodeText + 's'}}</button>
              </div>
            </div>

            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">验证码：</div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="2">
                <input nz-input nzSize="default" [(ngModel)]="operateObject.code">
              </div>
            </div>
            <ng-template #adjustSendModalFooter>
              <button nz-button nzType="primary" (click)="doSave('adjustSend')" [disabled]="operateObject.code.length !== 4">执行发送</button>
              <button nz-button nzType="default" (click)="hideModal('adjustSend')">放弃</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.adjustDetail" nzWidth="950" nzTitle="查看详情" [nzFooter]="adjustDetailModalFooter" (nzOnCancel)="hideModal('adjustDetail')" nzMaskClosable="false">
            <div *ngIf="adjustDetail">
              <div nz-row>
                <div nz-col nzSpan="2"></div>
                <div nz-col nzSpan="5">发放日期<br>{{adjustDetail.createDate ? (adjustDetail.createDate | date:'yyyy-MM-dd') : 'null'}}</div>
                <div nz-col nzSpan="5">发放时间<br>{{adjustDetail.createTime}}</div>
                <div nz-col nzSpan="5">发放人数<br>{{adjustDetail.all}}</div>
                <div nz-col nzSpan="5">失败人数<br>{{adjustDetail.failNum}}</div>
                <div nz-col nzSpan="2"></div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="24">
                  <nz-table nzBordered #rowsSuccessDataTable [nzData]="adjustDetail.itemsArr" [nzSimple]="true">
                    <thead>
                      <tr>
                        <th>发送成功(总计x个)</th>
                        <th>奖励配置</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr *ngFor="let data of rowsSuccessDataTable.data; let i=index;">
                        <td>{{data.key}}</td>
                        <td>{{data.value}}</td>
                      </tr>
                    </tbody>
                  </nz-table>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="11" class="spthumbnailan_down">失败对象(总计{{adjustDetail.failNum}}个)</div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="11" class="spthumbnailan_down">附带消息</div>
                <div nz-col nzSpan="1"></div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="11">
                  <textarea rows="5" nz-input [(ngModel)]="adjustDetail.fail" [disabled]="true" nzSize="default"></textarea>
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="11">
                  <textarea rows="5" nz-input [(ngModel)]="adjustDetail.noticeContent" [disabled]="true" nzSize="default"></textarea>
                </div>
                <div nz-col nzSpan="1"></div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="11" class="spthumbnailan_down">调整原因</div>
                <div nz-col nzSpan="1"></div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="11">
                  <textarea rows="5" nz-input [(ngModel)]="adjustDetail.adjustReason" [disabled]="true" nzSize="default"></textarea>
                </div>
                <div nz-col nzSpan="1"></div>
              </div>
            </div>
            <ng-template #adjustDetailModalFooter>
              <button nz-button nzType="default" (click)="hideModal('adjustDetail')"><i class="anticon anticon-close-circle-o"></i>关闭</button>
            </ng-template>
          </nz-modal>
        </nz-tab>

        <nz-tab [nzTitle]="businessTemplate" (nzClick)="changePanel('business')" *ngIf="commonService.haveMenuPermission('children', '充值记录')">
          <ng-template #businessTemplate><i class="anticon anticon-bank"></i>交易记录</ng-template>
          <form [formGroup]="searchBusinessForm">
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="phone" [(ngModel)]="businessPhone" placeholder="输入用户账号" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">交易类型：</div>
              <div nz-col nzSpan="3">
                <nz-select formControlName="businessType">
                  <nz-option required [nzLabel]="'全部'" nzValue=""></nz-option>
                  <nz-option required [nzLabel]="'机票'" nzValue="FLIGHT"></nz-option>
                  <nz-option required [nzLabel]="'火车'" nzValue="TRAIN"></nz-option>
                  <nz-option required [nzLabel]="'酒店'" nzValue="HOTEL"></nz-option>
                  <nz-option required [nzLabel]="'打车'" nzValue="TAXI"></nz-option>
                  <nz-option required [nzLabel]="'充话费'" nzValue="PHONE_CHARGE"></nz-option>
                  <!-- <nz-option required [nzLabel]="'星座运势'" nzValue="HOROSCOPE"></nz-option> -->
                  <nz-option required [nzLabel]="'恋爱运势'" nzValue="PAIR"></nz-option>
                  <nz-option required [nzLabel]="'月运势'" nzValue="FORTUNE"></nz-option>
                  <nz-option required [nzLabel]="'闪送'" nzValue="EXPRESS"></nz-option>
                  <nz-option required [nzLabel]="'电影票'" nzValue="MOVIE"></nz-option>
                  <nz-option required [nzLabel]="'音乐'" nzValue="MUSIC"></nz-option>
                  <nz-option required [nzLabel]="'充值'" nzValue="WALLET"></nz-option>
                  <nz-option required [nzLabel]="'任务'" nzValue="TASK"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">交易方式：</div>
              <div nz-col nzSpan="3">
                <nz-select formControlName="tradeMode">
                  <nz-option required [nzLabel]="'全部'" nzValue=""></nz-option>
                  <nz-option required [nzLabel]="'微信'" nzValue="WECHAT"></nz-option>
                  <nz-option required [nzLabel]="'支付宝'" nzValue="ALI"></nz-option>
                  <nz-option required [nzLabel]="'小悟币'" nzValue="COIN"></nz-option>
                  <nz-option required [nzLabel]="'小悟豆'" nzValue="BEAN"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" [nzPlaceHolder]="['交易开始日期', '交易结束日期']" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'business')"></nz-range-picker>
              </div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="loadData('business')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
          </form>

          <nz-table nzBordered #rowSelectionBusinessTable [nzData]="businessData" [nzSimple]="true" [nzScroll]="{x:'1800px'}">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户账号</th>
                <th>用户昵称</th>
                <th>交易类型</th>
                <th>交易方式</th>
                <th>交易金额</th>
                <th>交易小悟币</th>
                <th>交易小悟豆</th>
                <th>订单号</th>
                <th>交易时间</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionBusinessTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.account}}</td>
                <td>{{data.nickname}}</td>
                <td>{{data.businessType === 'FLIGHT' ? '机票' : data.businessType === 'TRAIN' ? '火车' : data.businessType === 'HOTEL' ? '酒店' :
                   data.businessType === 'TAXI' ? '打车' : data.businessType === 'PHONE_CHARGE' ? '充话费' :
                   data.businessType === 'PAIR' ? '恋爱运势' : data.businessType === 'FORTUNE' ? '月运势' : data.businessType === 'EXPRESS' ? '闪送' :
                   data.businessType === 'MOVIE' ? '电影票' : data.businessType === 'MUSIC' ? '音乐' : data.businessType === 'WALLET' ? '充值' :
                   data.businessType === 'TASK' ? '任务' : ''}}</td>
                <td>{{data.paymentType === 'WECHAT_PAY' ? '微信' : data.paymentType === 'ALI_PAY' ? '支付宝' : data.currencyType === 'RMB' ? '人民币' : data.currencyType === 'BEAN' ? '小悟豆' : data.currencyType === 'COIN' ? '小悟币' : '' }}</td>
                <td>{{data.paymentType === 'WECHAT_PAY' || data.paymentType === 'ALI_PAY' ? data.amount : data.currencyType === 'RMB' ? data.amount : '/'}}</td>
                <td>{{(data.paymentType === 'WALLET_PAY' || !data.paymentType) && data.currencyType === 'COIN' ? data.amount : '/'}}</td>
                <td>{{(data.paymentType === 'WALLET_PAY' || !data.paymentType) && data.currencyType === 'BEAN' ? data.amount : '/'}}</td>
                <td><a [ngStyle]="{'color': data.businessType === 'WALLET' || data.businessType === 'TASK' ? '#000' : '#1890ff', 'cursor': data.businessType === 'WALLET' || data.businessType === 'TASK' ? 'none' : 'pointer' }" (click)="showModal('recordGoOrder', data)">{{data.businessId}}</a></td>
                <td>{{data.createTime }}</td>
              </tr>
            </tbody>
          </nz-table>

        </nz-tab>

        <nz-tab [nzTitle]="invoiceTemplate" (nzClick)="changePanel('invoice')" *ngIf="commonService.haveMenuPermission('children', '开票记录')">
          <ng-template #invoiceTemplate><i class="anticon anticon-file"></i>开票记录</ng-template>
          <form [formGroup]="searchInvoiceForm">
            <div nz-row>
              <div nz-col nzSpan="2" class="right_alignment">用户账号：</div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="phone" [(ngModel)]="invoicePhone" placeholder="输入用户账号" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">开票类型：</div>
              <div nz-col nzSpan="2">
                <nz-select [(ngModel)]="invoiceType" formControlName="type">
                  <nz-option required [nzLabel]="'全部'" nzValue=""></nz-option>
                  <nz-option required [nzLabel]="'机票'" nzValue="FLIGHT"></nz-option>
                  <nz-option required [nzLabel]="'酒店'" nzValue="HOTEL"></nz-option>
                  <nz-option required [nzLabel]="'打车'" nzValue="TAXI"></nz-option>
                  <!-- <nz-option required [nzLabel]="'充话费'" nzValue="COIN"></nz-option> -->
                  <nz-option required [nzLabel]="'闪送'" nzValue="EXPRESS"></nz-option>
                  <!-- <nz-option required [nzLabel]="'星座'" nzValue="COIN"></nz-option> -->
                </nz-select>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">开票状态：</div>
              <div nz-col nzSpan="2">
                <nz-select [(ngModel)]="invoiceState" formControlName="state">
                  <nz-option required [nzLabel]="'全部状态'" nzValue=""></nz-option>
                  <nz-option required [nzLabel]="'开票失败'" nzValue="0"></nz-option>
                  <nz-option required [nzLabel]="'已开票'" nzValue="1"></nz-option>
                  <nz-option required [nzLabel]="'开票中'" nzValue="2"></nz-option>
                  <nz-option required [nzLabel]="'待开票'" nzValue="3"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2" class="right_alignment">开票时间：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyy-MM-dd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'invoice')"></nz-range-picker>
              </div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="loadData('invoice', '')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
          </form>

          <nz-table nzBordered #rowSelectionInvoiceTable [nzData]="invoiceData" [nzSimple]="true">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户账号</th>
                <th>用户昵称</th>
                <th>开票金额</th>
                <th>收件邮箱</th>
                <th>开票类型</th>
                <th>开票状态</th>
                <th>申请时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionInvoiceTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.account}}</td>
                <td>{{data.nickname}}</td>
                <td>{{data.invoicePrice}}</td>
                <td>{{data.invoiceMsg.email}}</td>
                <td>{{data.orderType === 'FlightOrder' ? '机票' : data.orderType === 'HotelOrder' ? '酒店' : data.orderType === 'TaxiOrder' ? '打车' : data.orderType === 'FlashOrder' ? '闪送' : 'null' }}</td>
                <td>{{data.state === 0 ? '开票失败' : data.state === 1 ? '已开票' : data.state === 2 ? '开票中' : data.state === 3 ? '待开票' : 'null'}}</td>
                <td>{{data.createTime}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('invoiceInfoDetail', data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>查看</button>
                </td>
              </tr>
            </tbody>
          </nz-table>

          <nz-modal [(nzVisible)]="visiable.invoiceDetail" nzWidth="950" nzTitle="开票详情" [nzFooter]="invoiceDetail1ModalFooter" (nzOnCancel)="hideModal('invoiceInfoDetail')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">用户账号：</div> <div nz-col nzSpan="8">{{invoiceItem.account}}</div>
              <div nz-col nzSpan="4" class="right_alignment">用户昵称：</div> <div nz-col nzSpan="8">{{invoiceItem.nickname}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开票金额：</div> <div nz-col nzSpan="8">{{invoiceItem.invoicePrice}}</div>
              <div nz-col nzSpan="4" class="right_alignment">申请时间：</div> <div nz-col nzSpan="8">{{invoiceItem.createTime}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">开票状态：</div> <div nz-col nzSpan="8">{{invoiceItem.state === 0 ? '开票失败' : invoiceItem.state === 1 ? '已开票' : invoiceItem.state === 2 ? '开票中' : invoiceItem.state === 3 ? '待开票' : 'null'}}</div>
              <div nz-col nzSpan="4" class="right_alignment">开票类型：</div> <div nz-col nzSpan="8">{{invoiceItem.orderType === 'FlightOrder' ? '机票' : invoiceItem.orderType === 'HotelOrder' ? '酒店' : invoiceItem.orderType === 'TaxiOrder' ? '打车' : invoiceItem.orderType === 'FlashOrder' ? '闪送' : 'null'}}</div>
            </div>
            <div *ngIf="invoiceItem.invoiceMsg">
              <div nz-row>
                <div nz-col nzSpan="4" class="right_alignment">公司名称：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.invoiceName}}</div>
                <div nz-col nzSpan="4" class="right_alignment">纳税人识别号：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.dutyParagraph}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="4" class="right_alignment">收件邮箱：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.email}}</div>
                <div nz-col nzSpan="4" class="right_alignment">手机号：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.phone}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="4" class="right_alignment">注册地址：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.registerAdd}}</div>
                <div nz-col nzSpan="4" class="right_alignment">注册电话：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.registerPhone}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="4" class="right_alignment">开户银行：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.bank}}</div>
                <div nz-col nzSpan="4" class="right_alignment">开户账户：</div> <div nz-col nzSpan="8">{{invoiceItem.invoiceMsg.account}}</div>
              </div>
            </div>
            <nz-table nzBordered #rowSelectionInvoiceDetailTable [nzData]="invoiceItem.orderIds">
              <thead>
                <tr>
                  <th>序号</th> <th>订单号</th> <th>出发地</th> <th>目的地</th> <th>订单金额</th> <th>订单状态</th> <th>出发时间</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of rowSelectionInvoiceDetailTable.data; let i=index;">
                  <td>{{i+1}}</td> <td>{{data}}</td> <td>{{data.aaaaa}}</td> <td>{{data.aaaaa}}</td> <td>{{data.aaaaa}}</td> <td>{{data.aaaaa}}</td> <td>{{data.aaaaa}}</td>
                </tr>
              </tbody>
            </nz-table>
            <ng-template #invoiceDetail1ModalFooter>
              <button nz-button nzType="default" (click)="hideModal('invoiceInfoDetail')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

      </nz-tabset>
    </nz-card-tab>
  </nz-card>
</div>
