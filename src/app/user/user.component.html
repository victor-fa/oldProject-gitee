<app-left-nav></app-left-nav>
<div class="user" [ngStyle]="{'left': !commonService.isLeftNavClose ? 'calc(240px)' : 'calc(80px)','width': !commonService.isLeftNavClose ? 'calc(100% - 240px)' : 'calc(100% - 80px)'}">
  <nz-card style="width: 100%;">
    <nz-card-tab>
      <nz-tabset nzSize="large" [(nzSelectedIndex)]="index2">
        <nz-tab nzTitle="用户管理">
          <form [formGroup]="searchForm">
            <div nz-row class="search_panel">
              <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                <!-- 用户名： -->
                用户ID：
              </div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="userName" maxlength="10" onkeyup="this.value=this.value.replace(/(^\s*)|(\s*$)/g,'')" placeholder="输入用户名"
                  nzSize="default">
              </div>

              <div nz-col nzSpan="2" class="span_down right_alignment">
                手机号：
              </div>
              <div nz-col nzSpan="3">
                <input nz-input formControlName="phoneNum" maxlength="11" onkeyup="this.value=this.value.replace(/(^\s*)|(\s*$)/g,'')" placeholder="输入手机号"
                  nzSize="default">
              </div>

              <div nz-col nzSpan="12">
              </div>

              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="doSearch()"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
          </form>

          <nz-table #rowSelectionTable [nzData]="data" [nzSimple]="true" [nzShowPagination]="false">
            <thead>
              <tr>
                <th>序号</th>
                <th>用户名</th>
                <th>用户ID</th>
                <th>是否拉黑</th>
                <th>在系统状态</th><!-- 1.正常 = 成功登录过齐悟前端产品 2.未激活 = 请求了验证码，但是没有登录成功过 3.黑名单 = 被拉入了黑名单 -->
                <th>短信请求次数</th>
                <th>第一次注册时间</th>
                <th>上次登录时间</th>
                <th>手机号</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of rowSelectionTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.nickName}}</td>
                <td>{{data.userId}}</td>
                <td>{{data.locked}}</td>
                <td>{{data.status}}</td>
                <td>{{data.sentCount}}</td>
                <td>{{data.createTime | date:'yyyy-MM-dd HH:mm' }}</td>
                <td>{{data.updateTime | date:'yyyy-MM-dd HH:mm' }}</td>
                <td>{{data.userPhone}}</td>
                <td>
                  <button nz-button nzType="primary" *ngIf="data.locked !== '已拉黑'" (click)="showBlacklistModal(data)" style="margin-right: 10px;">拉黑</button>
                  <button nz-button nzType="primary" *ngIf="data.locked === '已拉黑'" disabled style="margin-right: 10px;">拉黑</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div nz-row style="margin: 10px 0;line-height: 30px;">
            <div nz-col nzSpan="18"></div>
            <div nz-col nzSpan="1" *ngIf="changePage !== 1"><button nz-button nzType="primary" (click)="lastPage()"><i class="anticon anticon-left"></i></button></div>
            <div nz-col nzSpan="1" *ngIf="changePage === 1"><button disabled nz-button nzType="primary"><i class="anticon anticon-left"></i></button></div>
            <div nz-col nzSpan="4">当前为 {{changePage}} / {{allSize}} 页 &nbsp;&nbsp; 共 {{total}} 条</div>
            <div nz-col nzSpan="1" *ngIf="changePage !== allSize"><button nz-button nzType="primary" (click)="nextPage()"><i class="anticon anticon-right"></i></button></div>
            <div nz-col nzSpan="1" *ngIf="changePage === allSize"><button disabled nz-button nzType="primary"><i class="anticon anticon-right"></i></button></div>
          </div>
        </nz-tab>


        <nz-tab nzTitle="发送短信">
          <form [formGroup]="sendMsgForm">
            <div nz-row>
              <div nz-col nzSpan="24"><br><br><br><br><br><br><br><br><br><br></div>
            </div>
            <div nz-row class="search_panel">
              <div nz-col nzSpan="6"></div>
              <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                手机号：
              </div>
              <div nz-col nzSpan="3">
                <input nz-input maxlength="11" formControlName="phoneNum" onkeyup="this.value=this.value.replace(/(^\s*)|(\s*$)/g,'')"
                  placeholder="输入手机号" nzSize="default">
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="showSendMsgModal()"><i class="anticon anticon-message"></i>发送</button>
              </div>
            </div>
            <div nz-row [ngStyle]="{'height': sendScreenHeight}"></div>
          </form>
        </nz-tab>
      </nz-tabset>
    </nz-card-tab>
  </nz-card>
</div>
