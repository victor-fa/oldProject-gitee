<app-left-nav></app-left-nav>
<div class="content" [ngStyle]="{'left': !commonService.isLeftNavClose ? 'calc(240px)' : 'calc(80px)','width': !commonService.isLeftNavClose ? 'calc(100% - 240px)' : 'calc(100% - 80px)'}">
  <nz-card style="width: 100%;">
    <nz-card-tab>
      <nz-tabset nzSize="large">
        <nz-tab [nzTitle]="taxiTemplate" (nzClick)="changePanel('taxi')" *ngIf="commonService.haveMenuPermission('children', '打车监控')">
          <ng-template #taxiTemplate><i class="anticon anticon-car"></i>打车监控</ng-template>
          <div nz-row>
            <div nz-col nzSpan="19">
              <form [formGroup]="searchTaxiForm">
                <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                  订单号：
                </div>
                <div nz-col nzSpan="4">
                  <input nz-input maxlength="32" formControlName="orderId" placeholder="输入订单编号"
                    nzSize="default">
                </div>
                <div nz-col nzSpan="1">
                </div>
                <div nz-col nzSpan="2" class="span_down right_alignment">
                  报警时间：
                </div>
                <div nz-col nzSpan="7" class="span_down">
                  <nz-range-picker formControlName="date" [nzFormat]="'yyyy-MM-dd'" [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'taxi')"></nz-range-picker>
                </div>

              </form>
            </div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('taxi')"><i class="anticon anticon-search"></i>查询</button>
            </div>
          </div>
          <nz-table #taxiTable [nzData]="dataTaxi" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th nzWidth="20px">序号</th>
                <th nzWidth="20px">订单id</th>
                <th nzWidth="20px">用户手机号</th>
                <th nzWidth="20px">用户昵称</th>
                <th nzWidth="20px">司机手机号</th>
                <th nzWidth="20px">打车计价</th>
                <th nzWidth="20px">可用小悟币</th>
                <th nzWidth="20px">可用小悟豆</th>
                <th nzWidth="20px">预估价格</th>
                <th nzWidth="20px">报警原因</th>
                <th nzWidth="20px">报警时间</th>
                <th nzWidth="20px">操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of taxiTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.orderId}}</td>
                <td>{{data.userPhone}}</td>
                <td>{{data.userNickName}}</td>
                <td>{{data.driverPhone}}</td>
                <td>{{data.nowPrice}}</td>
                <td>{{data.availableAmount}}</td>
                <td>{{data.availableBeans}}</td>
                <td>{{data.estimate_price}}</td>
                <td>{{data.monitorType !== null ? (data.monitorType === 0 ? '余额不足' : (data.monitorType === 1 ? '超出预估' : 'null')) : 'null'}}</td>
                <td>{{data.createDate}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('taxi', data)"><i
                      class="anticon anticon-form"></i>详情</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹框 —— 详情 —— 打车路径 -->
          <nz-modal [(nzVisible)]="visiable.taxiDetail" nzWidth="1150" nzTitle="打车监控" [nzFooter]="taxiDetailModalFooter" (nzOnCancel)="hideModal('taxi')" nzMaskClosable="false">
              <!-- 打车路径详情 -->
            <div nz-row>
              <div nz-col nzSpan="8">
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">订单号：</div><div nz-col nzSpan="16">{{currentTaxi.orderId}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">司机电话：</div><div nz-col nzSpan="16">{{currentTaxi.driverPhone}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">用户账号：</div><div nz-col nzSpan="16">{{currentTaxi.userPhone}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">用户昵称：</div><div nz-col nzSpan="16">{{currentTaxi.userNickName}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">打车计价：</div><div nz-col nzSpan="16">{{currentTaxi.nowPrice}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">可用小悟币：</div><div nz-col nzSpan="16">{{currentTaxi.availableAmount}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">可用小悟豆：</div><div nz-col nzSpan="16">{{currentTaxi.availableBeans}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">打车预估价：</div><div nz-col nzSpan="16">{{currentTaxi.estimate_price}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">打车平台：</div><div nz-col nzSpan="16">{{currentTaxi.source ? (currentTaxi.source === 'didi' ? '滴滴平台' : (currentTaxi.source === 'shenzhou' ? '神州平台' : (currentTaxi.source === 'yidao' ? '易到平台' : (currentTaxi.source === 'shouqi' ? '首汽平台' : (currentTaxi.source === 'caocao' ? '曹操' : 'null'))))) : 'null'}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">报警原因：</div><div nz-col nzSpan="16">{{currentTaxi.monitorType !== null ? (currentTaxi.monitorType === 0 ? '余额不足' : (currentTaxi.monitorType === 1 ? '超出预估' : 'null')) : 'null'}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">报警时间：</div><div nz-col nzSpan="16">{{currentTaxi.createDate}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">起始地点：</div><div nz-col nzSpan="16">{{currentTaxi.originName}}</div>
                </div>
                <div nz-row>
                  <div nz-col nzSpan="8" class="right_alignment">目标地点：</div><div nz-col nzSpan="16">{{currentTaxi.destinationName}}</div>
                </div>
              </div>
              <div nz-col nzSpan="16">
                <div id='container' style='width: 100%; height: 400px;'></div>
              </div>
            </div>

            <!-- 弹框和底部定制 -->
            <ng-template #taxiDetailModalFooter>
              <button nz-button nzType="default" (click)="refreshMap()"><i class="anticon anticon-refresh"></i>刷新</button>
              <button nz-button nzType="default" (click)="hideModal('taxi')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>


        <nz-tab [nzTitle]="voiceTemplate" (nzClick)="changePanel('voice')" *ngIf="commonService.haveMenuPermission('children', 'ASR语音切换')">
          <ng-template #voiceTemplate><i class="anticon anticon-sound"></i>ASR语音切换</ng-template>
          <div nz-row>
            <div nz-col nzSpan="24" class="span_down" style="font-size: 20px;font-weight: bold;">iOS语音ASR配置</div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="2" class="span_down spacing right_alignment">{{this.commonService.AppHeaderAllow[this.commonService.currentChanelId]}}</div>
            <div nz-col nzSpan="1"></div>
            <div nz-col nzSpan="9" class="span_down">
              <nz-radio-group [(ngModel)]="voiceIOSRadioValue">
                <label nz-radio nzValue="BAI_DU" [(nzDisabled)]="!isSaveIOSVoiceButton">百度ASR</label>
                <label nz-radio nzValue="XUN_FEI" [(nzDisabled)]="!isSaveIOSVoiceButton">讯飞ASR</label>
              </nz-radio-group>
            </div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="2">
              <button *ngIf="!isSaveIOSVoiceButton" nz-button nzType="primary" (click)="doSave('editVoiceIOS', '')"><i class="anticon anticon-form"></i>编辑</button>
              <button *ngIf="isSaveIOSVoiceButton" nz-button nzType="primary" (click)="doSave('saveVoicceIOS', '')"><i class="anticon anticon-save"></i>保存</button>
            </div>
            <div nz-col nzSpan="2" *ngIf="isSaveIOSVoiceButton">
              <button nz-button nzType="primary" (click)="hideModal('voicceIOS')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </div>
          </div>

          <div nz-row>
            <div nz-col nzSpan="24" class="span_down" style="font-size: 20px;font-weight: bold;">安卓语音ASR配置</div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="2" class="span_down spacing right_alignment">{{this.commonService.AppHeaderAllow[this.commonService.currentChanelId]}}</div>
            <div nz-col nzSpan="1"></div>
            <div nz-col nzSpan="9" class="span_down">
              <nz-radio-group [(ngModel)]="voiceANDROIDRadioValue">
                <label nz-radio nzValue="BAI_DU" [(nzDisabled)]="!isSaveANDROIDVoiceButton">百度ASR</label>
                <label nz-radio nzValue="XUN_FEI" [(nzDisabled)]="!isSaveANDROIDVoiceButton">讯飞ASR</label>
              </nz-radio-group>
            </div>
          </div>
          <div nz-row>
            <div nz-col nzSpan="2">
              <button *ngIf="!isSaveANDROIDVoiceButton" nz-button nzType="primary" (click)="doSave('editVoiceANDROID', '')"><i class="anticon anticon-form"></i>编辑</button>
              <button *ngIf="isSaveANDROIDVoiceButton" nz-button nzType="primary" (click)="doSave('saveVoicceANDROID', '')"><i class="anticon anticon-save"></i>保存</button>
            </div>
            <div nz-col nzSpan="2" *ngIf="isSaveANDROIDVoiceButton">
              <button nz-button nzType="primary" (click)="hideModal('voicceANDROID')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </div>
          </div>
        </nz-tab>


        <nz-tab [nzTitle]="orderStateTemplate" (nzClick)="changePanel('orderState')" *ngIf="commonService.haveMenuPermission('children', '订单状态监控')">
          <ng-template #orderStateTemplate><i class="anticon anticon-eye-o"></i>订单状态监控</ng-template>
          <div nz-row>
            <div nz-col nzSpan="22">
              <form [formGroup]="searchOrderStateForm">
                <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                  订单号：
                </div>
                <div nz-col nzSpan="3">
                  <input nz-input maxlength="32" formControlName="orderId" placeholder="输入订单编号" nzSize="default">
                </div>
                <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                  订单类型：
                </div>
                <div nz-col nzSpan="3">
                  <nz-select [(ngModel)]="taxiOrderType" formControlName="orderType">
                    <nz-option [nzLabel]="'全部'" [nzValue]="''"></nz-option>
                    <nz-option required [nzLabel]="'火车'" [nzValue]="'TRAIN_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'机票'" [nzValue]="'FLIGHT_RETURN_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'酒店'" [nzValue]="'HOTEL_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'打车'" [nzValue]="'TAXI_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'闪送'" [nzValue]="'EXPRESS_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'充话费'" [nzValue]="'PHONE_CHARGE_ORDER'"></nz-option>
                    <nz-option required [nzLabel]="'电影票'" [nzValue]="'MOVIE_ORDER'"></nz-option>
                  </nz-select>
                </div>
                <div nz-col nzSpan="2" class="span_down spacing right_alignment">
                  订单状态：
                </div>
                <div nz-col nzSpan="3">
                  <nz-select [(ngModel)]="taxiOrderState" formControlName="state">
                    <nz-option [nzLabel]="'全部'" [nzValue]="''"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'EXPRESS_ORDER'" required [nzLabel]="'等待接单'" [nzValue]="'DENGDAIJIEDAN'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'EXPRESS_ORDER'" required [nzLabel]="'已接单'" [nzValue]="'YIJIEDAN'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'EXPRESS_ORDER'" required [nzLabel]="'已到达寄件地址'" [nzValue]="'YIDAODAJIJIANDIZHI'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'EXPRESS_ORDER'" required [nzLabel]="'配送中'" [nzValue]="'PEISONGZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'PHONE_CHARGE_ORDER'" required [nzLabel]="'充值中'" [nzValue]="'CHONGZHIZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TRAIN_ORDER' || taxiOrderType === 'TAXI_ORDER'" required [nzLabel]="'占座中'" [nzValue]="'ZHANZUOZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TRAIN_ORDER' || taxiOrderType === 'FLIGHT_ORDER' || taxiOrderType === 'HOTEL_ORDER' || taxiOrderType === 'MOVIE_ORDER'" required [nzLabel]="'出票中'" [nzValue]="'CHUPIAOZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'HOTEL_ORDER'" required [nzLabel]="'取消中'" [nzValue]="'QUXIAOZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TRAIN_ORDER' || taxiOrderType === 'FLIGHT_ORDER'" required [nzLabel]="'退票中'" [nzValue]="'TUIPIAOZHONG'"></nz-option>
                    <nz-option required [nzLabel]="'退款中'" [nzValue]="'TUIKUANZHONG'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TAXI_ORDER'" required [nzLabel]="'司机到达'" [nzValue]="'SIJIDAODA'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TAXI_ORDER'" required [nzLabel]="'待接驾'" [nzValue]="'DAIJIEJIA'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TAXI_ORDER'" required [nzLabel]="'司机已到达'" [nzValue]="'SIJIYIDAODA'"></nz-option>
                    <nz-option *ngIf="taxiOrderType === 'TAXI_ORDER'" required [nzLabel]="'进行中'" [nzValue]="'JINXINGZHONG'"></nz-option>
                  </nz-select>
                </div>
                <div nz-col nzSpan="2" class="span_down right_alignment">
                  报警时间：
                </div>
                <div nz-col nzSpan="7" class="span_down">
                  <nz-range-picker formControlName="date" [nzFormat]="'yyyy-MM-dd'" [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'orderState')"></nz-range-picker>
                </div>

              </form>
            </div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('orderState')"><i class="anticon anticon-search"></i>查询</button>
            </div>
          </div>
          <nz-table #orderStateTable [nzData]="dataOrderState" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th nzWidth="20px">序号</th>
                <th nzWidth="20px">订单号</th>
                <th nzWidth="20px">用户账号</th>
                <th nzWidth="20px">用户昵称</th>
                <th nzWidth="20px">订单类型</th>
                <th nzWidth="20px">订单状态</th>
                <th nzWidth="20px">报警类型</th>
                <th nzWidth="20px">报警时间</th>
                <th nzWidth="20px">操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of orderStateTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.orderId}}</td>
                <td>{{data.userPhone}}</td>
                <td>{{data.userNickName}}</td>
                <td>{{data.orderType === 'FLIGHT_ORDER' || data.orderType === 'FLIGHT_RETURN_ORDER' ? '机票' : data.orderType === 'TRAIN_ORDER' ? '火车' : data.orderType === 'HOTEL_ORDER' ? '酒店' : data.orderType === 'TAXI_ORDER' ? '打车' : data.orderType === 'EXPRESS_ORDER' ? '闪送' : data.orderType === 'PHONE_CHARGE_ORDER' ? '充话费' : data.orderType === 'MOVIE_ORDER' ? '电影票' : data.orderType === 'MUSIC_ORDER' ? '付费音频' : data.orderType === 'JIAOYOU_GAME_ORDER' ? '交游天下游戏' : ''}}</td>
                <td>{{data.state === 'DENGDAIJIEDAN' ? '等待接单' : data.state === 'YIJIEDAN' ? '已接单' : data.state === 'YIDAODAJIJIANDIZHI' ? '已到达寄件地址' :
                  data.state === 'PEISONGZHONG' ? '配送中' : data.state === 'CHONGZHIZHONG' ? '充值中' : data.state === 'ZHANZUOZHONG' ? '占座中' : data.state === 'CHUPIAOZHONG' ? '出票中' :
                  data.state === 'QUXIAOZHONG' ? '取消中' : data.state === 'TUIPIAOZHONG' ? '退票中' : data.state === 'TUIKUANZHONG' ? '退款中' : data.state === 'SIJIDAODA' ? '司机到达' :
                  data.state === 'DAIJIEJIA' ? '待接驾' : data.state === 'SIJIYIDAODA' ? '司机已到达' : data.state === 'JINXINGZHONG' ? '进行中' : data.state === 'DAICHUXING' ? '待出行' : '' }}</td>
                <td>{{data.alertLevel === 'LOW' ? '低阈值报警' : data.alertLevel === 'HIGH' ? '高阈值报警' : '' }}</td>
                <td>{{data.alertTime}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="goTaxtOrder(data)"><i class="anticon anticon-eye-o"></i>查看</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>
        </nz-tab>



        <nz-tab [nzTitle]="orderStateSettingTemplate" (nzClick)="changePanel('orderStateSetting')" *ngIf="commonService.haveMenuPermission('children', '订单状态设置')">
          <ng-template #orderStateSettingTemplate><i class="anticon anticon-setting"></i>订单状态设置</ng-template>
          <nz-table #orderStateSettingTable [nzData]="dataOrderStateSetting" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th nzWidth="20px">序号</th>
                <th nzWidth="20px">BOT名称</th>
                <th nzWidth="20px">订单状态</th>
                <th nzWidth="20px">报警阈值1</th>
                <th nzWidth="20px">报警阈值2</th>
                <th nzWidth="20px">操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of orderStateSettingTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.orderType === 'TRAIN_ORDER' ? '火车' : data.orderType === 'FLIGHT_ORDER' || data.orderType === 'FLIGHT_RETURN_ORDER' ? '机票' : data.orderType === 'HOTEL_ORDER' ? '酒店' : data.orderType === 'TAXI_ORDER' ? '打车' : data.orderType === 'EXPRESS_ORDER' ? '闪送' : data.orderType === 'PHONE_CHARGE_ORDER' ? '充话费' : data.orderType === 'MOVIE_ORDER' ? '电影票' : data.orderType === 'PAIR_ORDER' ? '恋爱运势' : data.orderType === 'FORTUNE_ORDER' ? '月运势' : data.orderType === 'MUSIC_ORDER' ? '付费音频' : data.orderType === 'JIAOYOU_GAME_ORDER' ? '交游天下游戏' : ''}}</td>
                <td>{{data.state === 'CHUPIAOZHONG' ? '出票中' : data.state === 'TUIKUANZHONG' ? '退款中' : data.state === 'DAIZHIFU' ? '待支付' : data.state === 'DAICHUXING' ? '待出行' : data.state === 'CHUPIAOSHIBAI' ? '出票失败' : data.state === 'YIQUXIAO' ? '已取消' : data.state === 'YITUIKUAN' ? '已退款' : data.state === 'YICHUXING' ? '已出行' : data.state === 'JIAOYIGUANBI' ? '交易关闭' : data.state === 'GAIQIANZHONG' ? '改签中' : data.state === 'ZHANZUOZHONG' ? '占座中' : data.state === 'QUXIAOZHONG' ? '取消中' : data.state === 'TUIPIAOZHONG' ? '退票中' : data.state === 'CHUPIAOSHIBAITUIKUANZHONG' ? '出票失败退款中' : data.state === 'TUIKUANSHIBAI' ? '退款失败' : data.state === 'SIJIDAODA' ? '司机已到达' : data.state === 'CHAOSHIQUXIAO' ? '超时取消' : ''}}</td>
                <td>{{data.lowTimeDes}}</td>
                <td>{{data.highTimeDes}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('orderStateSetting', data)"><i class="anticon anticon-form"></i>修改</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹框 —— 详情 —— 修改状态监控 -->
          <nz-modal [(nzVisible)]="visiable.orderStateSetting" nzWidth="750" nzTitle="修改状态监控" [nzFooter]="orderStateSettingModalFooter" (nzOnCancel)="hideModal('orderStateSetting')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="8" class="span_down right_alignment">
                BOT名称：
              </div>
              <div nz-col nzSpan="10" class="span_down">
                {{currentOrderStateSetting.orderType === 'TRAIN_ORDER' ? '火车' : currentOrderStateSetting.orderType === 'FLIGHT_ORDER' || currentOrderStateSetting.orderType === 'FLIGHT_RETURN_ORDER' ? '机票' : currentOrderStateSetting.orderType === 'HOTEL_ORDER' ? '酒店' : currentOrderStateSetting.orderType === 'TAXI_ORDER' ? '打车' : currentOrderStateSetting.orderType === 'EXPRESS_ORDER' ? '闪送' : currentOrderStateSetting.orderType === 'PHONE_CHARGE_ORDER' ? '充话费' : currentOrderStateSetting.orderType === 'MOVIE_ORDER' ? '电影票' : currentOrderStateSetting.orderType === 'PAIR_ORDER' ? '恋爱运势' : currentOrderStateSetting.orderType === 'FORTUNE_ORDER' ? '月运势' : currentOrderStateSetting.orderType === 'MUSIC_ORDER' ? '付费音频' : currentOrderStateSetting.orderType === 'JIAOYOU_GAME_ORDER' ? '交游天下游戏' : ''}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="8" class="span_down right_alignment">
                订单状态：
              </div>
              <div nz-col nzSpan="10" class="span_down">
                {{currentOrderStateSetting.state === 'CHUPIAOZHONG' ? '出票中' : currentOrderStateSetting.state === 'TUIKUANZHONG' ? '退款中' : currentOrderStateSetting.state === 'DAIZHIFU' ? '待支付' : currentOrderStateSetting.state === 'DAICHUXING' ? '待出行' : currentOrderStateSetting.state === 'CHUPIAOSHIBAI' ? '出票失败' : currentOrderStateSetting.state === 'YIQUXIAO' ? '已取消' : currentOrderStateSetting.state === 'YITUIKUAN' ? '已退款' : currentOrderStateSetting.state === 'YICHUXING' ? '已出行' : currentOrderStateSetting.state === 'JIAOYIGUANBI' ? '交易关闭' : currentOrderStateSetting.state === 'GAIQIANZHONG' ? '改签中' : currentOrderStateSetting.state === 'ZHANZUOZHONG' ? '占座中' : currentOrderStateSetting.state === 'QUXIAOZHONG' ? '取消中' : currentOrderStateSetting.state === 'TUIPIAOZHONG' ? '退票中' : currentOrderStateSetting.state === 'CHUPIAOSHIBAITUIKUANZHONG' ? '出票失败退款中' : currentOrderStateSetting.state === 'TUIKUANSHIBAI' ? '退款失败' : currentOrderStateSetting.state === 'SIJIDAODA' ? '司机已到达' : currentOrderStateSetting.state === 'CHAOSHIQUXIAO' ? '超时取消' : ''}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="8" class="span_down right_alignment">
                报警阈值1：
              </div>
              <div nz-col nzSpan="8">
                <input nz-input [(ngModel)]="currentOrderStateSetting.lowTime" placeholder="请输入报警阈值1" nzSize="default">
              </div>
              <div nz-col nzSpan="8">
                <nz-radio-group [(ngModel)]="currentOrderStateSetting.time1" class="span_down">
                  <label nz-radio nzValue="0">分钟</label>
                  <label nz-radio nzValue="1">小时</label>
                  <label nz-radio nzValue="2">天</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="8" class="span_down right_alignment">
                报警阈值2：
              </div>
              <div nz-col nzSpan="8">
                <input nz-input [(ngModel)]="currentOrderStateSetting.highTime" placeholder="请输入报警阈值2" nzSize="default">
              </div>
              <div nz-col nzSpan="8">
                <nz-radio-group [(ngModel)]="currentOrderStateSetting.time2" class="span_down">
                  <label nz-radio nzValue="0">分钟</label>
                  <label nz-radio nzValue="1">小时</label>
                  <label nz-radio nzValue="2">天</label>
                </nz-radio-group>
              </div>
            </div>

            <!-- 弹框和底部定制 -->
            <ng-template #orderStateSettingModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyOrderStateSetting')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('orderStateSetting')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>


        <nz-tab [nzTitle]="whiteListTemplate" (nzClick)="changePanel('whiteList')" *ngIf="commonService.haveMenuPermission('children', '生产环境白名单')">
          <ng-template #whiteListTemplate><i class="anticon anticon-file-text"></i>白名单管理</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3" class="span_down">
              <button nz-button nzType="primary" (click)="showModal('addWhiteList', '')"><i class="anticon anticon-file-add"></i>新增白名单</button>
            </div>
          </div>
          <nz-table #whiteListTable [nzData]="dataWhiteList" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th nzWidth="20px">序号</th>
                <th nzWidth="20px">白名单账号</th>
                <th nzWidth="20px">白名单昵称</th>
                <th nzWidth="20px">操作人</th>
                <th nzWidth="20px">创建时间</th>
                <th nzWidth="20px">操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of whiteListTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.phone}}</td>
                <td>{{data.nickName}}</td>
                <td>{{data.operator}}</td>
                <td>{{data.createTime}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="goUserInfo(data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>查看</button>
                  <button nz-button nzType="primary" (click)="showModal('deleteWhiteList', data)"><i class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.whiteList" nzWidth="750" nzTitle="新增白名单" [nzFooter]="whiteListModalFooter" (nzOnCancel)="hideModal('addWhiteList')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24">可输入添加或以文件批量导入</div>
              <div nz-col nzSpan="24">
                <textarea rows="6" [(ngModel)]="whiteListDate.keys" nz-input></textarea>
              </div>
              <div nz-col nzSpan="4" class="span_down">
                <a href="javascript:;" class="a-upload"><i class="anticon anticon-upload"></i>上传文件
                  <input type="file" (change)="getExcel($event)" multiple="false" />
                </a>
              </div>
              <div nz-col nzSpan="6" class="span_down" style="margin-top: 15px;">支持.CSV，.xls，.xlsx</div>
            </div>
            <ng-template #whiteListModalFooter>
              <button nz-button nzType="primary" (click)="showModal('codeView')"><i class="anticon anticon-save"></i>确定</button>
              <button nz-button nzType="default" (click)="hideModal('addWhiteList')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.codeView" nzWidth="750" nzTitle="新增白名单" [nzFooter]="codeViewModalFooter" (nzOnCancel)="hideModal('codeView')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24" class="spthumbnailan_down">将添加以下账号为白名单</div>
              <div nz-col nzSpan="24">
                <textarea rows="6" [(ngModel)]="whiteListDate.keys" nz-input></textarea>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4">
                <nz-select [(ngModel)]="operateObject.operator">
                  <nz-option required [nzLabel]="'18682233554'" [nzValue]="'18682233554'"></nz-option>
                  <nz-option required [nzLabel]="'18665310035'" [nzValue]="'18665310035'"></nz-option>
                  <nz-option required [nzLabel]="'18516609441'" [nzValue]="'18516609441'"></nz-option>
                  <nz-option required [nzLabel]="'18682251210'" [nzValue]="'18682251210'"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="3">
                <button nz-button nzType="primary" (click)="doSave('sendMsg')" [disabled]="semdMesCodeText !== 60">{{semdMesCodeText === 60 ? '验证' : semdMesCodeText + 's'}}</button>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment span_down">
                验证码：
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="2">
                <input nz-input nzSize="default" [(ngModel)]="operateObject.code">
              </div>
            </div>
            <ng-template #codeViewModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addWhiteList')" [disabled]="operateObject.code.length !== 4">确定</button>
              <button nz-button nzType="default" (click)="hideModal('codeView')">取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

      </nz-tabset>
    </nz-card-tab>
  </nz-card>
</div>
