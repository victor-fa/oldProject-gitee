<app-left-nav></app-left-nav>
<div class="content" [ngStyle]="{'left': !commonService.isLeftNavClose ? 'calc(240px)' : 'calc(80px)','width': !commonService.isLeftNavClose ? 'calc(100% - 240px)' : 'calc(100% - 80px)'}">
  <nz-card>
    <nz-card-tab>
      <nz-tabset nzSize="large">
        <nz-tab [nzTitle]="contentTemplate" nzTitle="发文章" (nzClick)="changePanel('content')" *ngIf="commonService.haveMenuPermission('children', '发文章')">
          <ng-template #contentTemplate><i class="anticon anticon-file-text"></i>发文章</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showAddModal('content')"><i class="anticon anticon-file-add"></i>新增内容</button>
            </div>
          </div>
          <nz-table nzBordered #contentTable [nzData]="dataContent" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>缩略图</th>
                <th>标题</th>
                <th>类型</th>
                <th>阅读量</th>
                <th>链接</th>
                <th>发布人</th>
                <th>状态</th>
                <th>发布时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of contentTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td><img [src]="commonService.baseUrl.substring(0, commonService.baseUrl.indexOf('/admin')) + '/v1/cms/notices/thumbnails/' + data.thumbnail" class="thumbnail"></td>
                <td>{{data.title}}</td>
                <td>{{data.type == 'SKILL' ? '使用技巧' : data.type == 'OPERATION' ? '福利活动' : data.type == 'OCCURRENCE' ? '小悟动态' : '系统消息'}}</td>
                <td>{{data.readingAmount}}</td>
                <td style="max-width: 110px;overflow: hidden;text-overflow: ellipsis;white-space: nowrap;">
                  <div title="{{data.url}}">{{data.url === '' ? '自定义页面' : data.url === '1' ? '个人中心' : data.url === '2' ? '个人中心 > 设置' : data.url === '3' ? '个人中心 > 我的订单' : data.url === '4' ? '个人中心 > 常用信息' : data.url === '5' ? '个人中心 > 我的账户 > 充值' : data.url === '6' ? '个人中心 > 我的账户' : data.url === '7' ? '个人中心 > 联系我们 > 我的建议' : data.url === '8' ? '对话流 > 帮助' : data.url }}</div>
                </td>
                <td>{{data.pseudonym}}</td>
                <td>{{now >= data.publishTime ? '已发布' : '未发布'}}</td>
                <td>{{data.publishTime | date:'yyyy-MM-dd HH:mm:ss' }}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModifyModal(data, 'content')" style="margin-right: 10px;"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showDeleteModal(data, 'content')" style="margin-right: 10px;"><i class="anticon anticon-delete"></i>删除</button>
                  <button nz-button nzType="primary" (click)="doPreviewContent(data)" style="margin-right: 10px;"><i class="anticon anticon-eye-o"></i>预览</button>
                  <button nz-button nzType="primary" *ngIf="data.url === ''" (click)="doGetContentUrl(data)" style="margin-right: 10px;"><i class="anticon anticon-link"></i>获取地址</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹窗 —— 新增 —— 新增内容 -->
          <nz-modal [(nzVisible)]="visiable.addContent" nzWidth="1150" nzTitle="新增内容" [nzFooter]="addContentModalFooter" (nzOnCancel)="hideAddModal('content')" nzMaskClosable="false">
            <form [formGroup]="addContentForm">
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*标题：</div>
                <div nz-col nzSpan="22">
                  <input nz-input maxlength="25" formControlName="title" [(ngModel)]="emptyAdd[0]" placeholder="请输入标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*类型：</div>
                <div nz-col nzSpan="22">
                  <nz-select [ngModel]="''" formControlName="type" [(ngModel)]="emptyAdd[1]">
                    <nz-option [nzLabel]="'----无----'" [nzValue]="''"></nz-option>
                    <nz-option required [nzLabel]="'使用技巧'" [nzValue]="'SKILL'"></nz-option>
                    <nz-option required [nzLabel]="'福利活动'" [nzValue]="'OPERATION'"></nz-option>
                    <nz-option required [nzLabel]="'小悟动态'" [nzValue]="'OCCURRENCE'"></nz-option>
                    <nz-option required [nzLabel]="'系统消息'" [nzValue]="'SYSTEM_MESSAGE'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">url：</div>
                <div nz-col nzSpan="22">
                  <input nz-input formControlName="url" [(ngModel)]="emptyAdd[2]" placeholder="若url不为空，则默认使用url访问文章详情" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2"></div>
                <div nz-col nzSpan="22">
                  <font color="#A9A9A9">若url不为空，则默认使用url访问文章详情；填数字1~8，文章跳转到APP对应页面，对应关系如下所示
                    <br>
                    1：个人中心&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2：个人中心 > 设置&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    3：个人中心 > 我的订单&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4：个人中心 > 常用信息&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    5：个人中心 > 我的账户 > 充值&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6：个人中心 > 我的账户&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    7：个人中心 > 联系我们 > 我的建议&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8：对话流 > 帮助</font>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*摘要：</div>
                <div nz-col nzSpan="22">
                  <textarea rows="4" nz-input formControlName="abstractContent" [(ngModel)]="emptyAdd[3]" maxlength="50" placeholder="请输入摘要" nzSize="default"></textarea>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment"><i class="anticon anticon-add"></i>缩略图：</div>
                <div nz-col nzSpan="22">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：110*110&nbsp;&nbsp;限制大小：50K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length == 1">
                <div nz-col nzSpan="2" class="right_alignment"></div>
                <div nz-col nzSpan="22">
                  <img *ngIf="imageUrl" [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：110*110&nbsp;&nbsp;限制大小：50K</font>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*发布时间：</div>
                <div nz-col nzSpan="22">
                  <nz-date-picker nzShowTime formControlName="publishTime" [(ngModel)]="emptyAdd[5]" required [nzFormat]="'yyyy-MM-dd HH:mm'" nzPlaceHolder="请输入发布时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*发布人：</div>
                <div nz-col nzSpan="22">
                  <input nz-input maxlength="20" formControlName="pseudonym" [(ngModel)]="emptyAdd[6]" placeholder="请输入发布人" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment"></div>
                <div nz-col nzSpan="22">
                  <quill-editor formControlName="content" [(ngModel)]="emptyAdd[4]" [modules]="commonService.config" [style]="{height: '350px'}"></quill-editor>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #addContentModalFooter>
              <button nz-button nzType="primary" (click)="doSave('content')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="primary" (click)="doPreviewContentAdd()"><i class="anticon anticon-eye-o"></i>预览</button>
              <button nz-button nzType="default" (click)="hideAddModal('content')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <!-- 弹窗 —— 修改 —— 修改内容 -->
          <nz-modal [(nzVisible)]="visiable.modifyContent" nzWidth="1150" nzTitle="修改内容" [nzFooter]="modifyContentModalFooter" (nzOnCancel)="hideModifyModal('content')" nzMaskClosable="false">
            <form [formGroup]="modifyContentForm">
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*标题：</div>
                <div nz-col nzSpan="22">
                  <input nz-input maxlength="25" formControlName="title" [(ngModel)]="contentDate.title" placeholder="请输入标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*类型：</div>
                <div nz-col nzSpan="22">
                  <nz-select [ngModel]="contentDate.type" formControlName="type">
                    <nz-option [nzLabel]="'----无----'" [nzValue]="''"></nz-option>
                    <nz-option required [nzLabel]="'使用技巧'" [nzValue]="'SKILL'"></nz-option>
                    <nz-option required [nzLabel]="'福利活动'" [nzValue]="'OPERATION'"></nz-option>
                    <nz-option required [nzLabel]="'小悟动态'" [nzValue]="'OCCURRENCE'"></nz-option>
                    <nz-option required [nzLabel]="'系统消息'" [nzValue]="'SYSTEM_MESSAGE'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">url：</div>
                <div nz-col nzSpan="22">
                  <input nz-input formControlName="url" [(ngModel)]="contentDate.url" placeholder="若url不为空，则默认使用url访问文章详情" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2"></div>
                <div nz-col nzSpan="22">
                  <font color="#A9A9A9">若url不为空，则默认使用url访问文章详情；填数字1~8，文章跳转到APP对应页面，对应关系如下所示
                    <br>
                    1：个人中心&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2：个人中心 > 设置&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    3：个人中心 > 我的订单&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;4：个人中心 > 常用信息&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    5：个人中心 > 我的账户 > 充值&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;6：个人中心 > 我的账户&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                    7：个人中心 > 联系我们 > 我的建议&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;8：对话流 > 帮助</font>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="spthumbnailan_down right_alignment">*摘要：</div>
                <div nz-col nzSpan="22">
                  <textarea rows="4" nz-input formControlName="abstractContent" [(ngModel)]="contentDate.abstractContent" maxlength="64" placeholder="请输入摘要" nzSize="default"></textarea>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment"><i class="anticon anticon-add"></i>缩略图：</div>
                <div nz-col nzSpan="22">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：110*110&nbsp;&nbsp;限制大小：50K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length === 1">
                <div nz-col nzSpan="2" class="right_alignment"></div>
                <div nz-col nzSpan="22">
                  <img [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：110*110&nbsp;&nbsp;限制大小：50K</font>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*发布时间：</div>
                <div nz-col nzSpan="22">
                  <nz-date-picker nzShowTime formControlName="publishTime" [(ngModel)]="contentDate.publishTime" required [nzFormat]="'yyyy-MM-dd HH:mm'" nzPlaceHolder="请输入发布时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">*发布人：</div>
                <div nz-col nzSpan="22">
                  <input nz-input maxlength="20" formControlName="pseudonym" [(ngModel)]="contentDate.pseudonym" placeholder="请输入发布人" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment"></div>
                <div nz-col nzSpan="22">
                  <quill-editor formControlName="content" [(ngModel)]="contentDate.content" [modules]="commonService.config" [style]="{height: '350px'}"></quill-editor>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #modifyContentModalFooter>
              <button nz-button nzType="primary" (click)="doModify('content')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="primary" (click)="doPreviewContentModify()"><i class="anticon anticon-eye-o"></i>预览</button>
              <button nz-button nzType="default" (click)="hideModifyModal('content')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="screenTemplate" (nzClick)="changePanel('screen')" *ngIf="commonService.haveMenuPermission('children', '开屏启动')">
          <ng-template #screenTemplate><i class="anticon anticon-desktop"></i>开屏启动</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showAddModal('screen')"><i class="anticon anticon-file-add"></i>新增开屏</button>
            </div>
          </div>
          <nz-table nzBordered #screenTable [nzData]="dataScreen" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>开屏标题</th>
                <th>持续时间设置</th>
                <th>到期时间</th>
                <th>跳过状态</th>
                <th>链接跳转状态</th>
                <th>链接地址</th>
                <th>APP标识</th>
                <th>开屏图片</th>
                <th>启用状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of screenTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.title}}</td>
                <td>{{data.duration}}s</td>
                <td>{{data.expireTime}}</td>
                <td>{{data.skip === true ? '可跳过' : '不可跳过' }}</td>
                <td>{{data.jump === 'DISABLED'? '不跳转' : data.jump === 'HTML' ? '跳转到网页' : '跳转到APP'}}</td>
                <td>{{data.url ? data.url !== '' ? data.url : '无' : '无'}}</td>
                <td>{{data.site === 1 ? '个人中心' : data.site === 2 ? '个人中心 > 设置' : data.site === 3 ? '个人中心 > 我的订单' : data.site === 4 ? '个人中心 > 常用信息' : data.site === 5 ? '个人中心 > 我的账户 > 充值' : data.site === 6 ? '个人中心 > 我的账户' : data.site === 7 ? '个人中心 > 联系我们 > 我的建议' : data.site === 8 ? '对话流 > 帮助' : '无'}}</td>
                <td><img [src]="commonService.baseUrl.substring(0, commonService.baseUrl.indexOf('/admin')) + '/v1/cms/start-page-ads/images/' + data.image" class="thumbnail"></td>
                <td>
                  <nz-form-item>
                    <nz-form-control>
                      <nz-switch [(ngModel)]="data.enabled" (click)="clickSwitch(data, 'screen')"></nz-switch>
                    </nz-form-control>
                  </nz-form-item>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModifyModal(data, 'screen')" style="margin-right: 10px;"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showDeleteModal(data, 'screen')" style="margin-right: 10px;"><i class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹窗 —— 新增 —— 新增开屏 -->
          <nz-modal [(nzVisible)]="visiable.addScreen" nzWidth="750" nzTitle="新增开屏" [nzFooter]="addScreenModalFooter" (nzOnCancel)="hideAddModal('screen')" nzMaskClosable="false">
            <form [formGroup]="addScreenForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>开屏标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input maxlength="18" formControlName="title" [(ngModel)]="screenDate.title"
                    placeholder="请输入开屏标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>持续时间：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input maxlength="2" formControlName="duration" [(ngModel)]="screenDate.duration"
                    placeholder="请输入持续时间（单位：s）" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="screenDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>链接跳转状态：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="jump" [(ngModel)]="jumpForScreen">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForScreen === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="site" [ngModel]="1">
                    <nz-option required nzTitle="prompt text" nzPlacement="topLeft" nz-tooltip [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"><div title="123123"></div></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">跳过状态：</div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="skip" [ngModel]="'true'">
                    <nz-option required [nzLabel]="'可跳过'" [nzValue]="'true'"></nz-option>
                    <nz-option required [nzLabel]="'不可跳过'" [nzValue]="'false'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForScreen === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="screenDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>开屏图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*1154&nbsp;&nbsp;限制大小：500K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length == 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img *ngIf="imageUrl" [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;议尺寸：750*1154&nbsp;&nbsp;限制大小：500K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #addScreenModalFooter>
              <button nz-button nzType="primary" (click)="doSave('screen')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideAddModal('screen')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <!-- 弹窗 —— 修改 —— 修改开屏 -->
          <nz-modal [(nzVisible)]="visiable.modifyScreen" nzWidth="750" nzTitle="修改开屏" [nzFooter]="modifyScreenModalFooter" (nzOnCancel)="hideModifyModal('screen')" nzMaskClosable="false">
            <form [formGroup]="modifyScreenForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>开屏标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input maxlength="18" formControlName="title" [ngModel]="screenDate.title"
                    placeholder="请输入开屏标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>持续时间：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input maxlength="2" formControlName="duration" [ngModel]="screenDate.duration"
                    placeholder="请输入持续时间" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="screenDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>链接跳转状态：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [(ngModel)]="screenDate.jump" formControlName="jump">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="screenDate.jump === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="screenDate.site" formControlName="site">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">跳过状态：</div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="screenDate.skip" formControlName="skip">
                      <nz-option required [nzLabel]="'可跳过'" [nzValue]="true"></nz-option>
                      <nz-option required [nzLabel]="'不可跳过'" [nzValue]="false"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="screenDate.jump === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [ngModel]="screenDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>开屏图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*1154&nbsp;&nbsp;限制大小：500K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length === 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*1154&nbsp;&nbsp;限制大小：500K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #modifyScreenModalFooter>
              <button nz-button nzType="primary" (click)="doModify('screen')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModifyModal('screen')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="openTemplate" (nzClick)="changePanel('open')" *ngIf="commonService.haveMenuPermission('children', '首页弹窗')">
          <ng-template #openTemplate><i class="anticon anticon-scan"></i>首页弹框</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showAddModal('open')"><i class="anticon anticon-file-add"></i>新增弹窗</button>
            </div>
          </div>
          <nz-table nzBordered #openTable [nzData]="dataOpen" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>弹窗标题</th>
                <th>跳转位置</th>
                <th>到期时间</th>
                <th>链接地址</th>
                <!-- <th>排序状态</th> -->
                <th>APP标识</th>
                <th>弹窗图片</th>
                <th>弹窗规则</th>
                <th>启用状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of openTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.title}}</td>
                <td>{{data.jump === 'DISABLED'? '不跳转' : data.jump === 'HTML' ? '跳转到网页' : '跳转到APP'}}</td>
                <td>{{data.expireTime}}</td>
                <td>{{data.url ? data.url !== '' ? data.url : '无' : '无'}}</td>
                <!-- <td>{{data.order}}</td> -->
                <td>{{data.site === 1 ? '个人中心' : data.site === 2 ? '个人中心 > 设置' : data.site === 3 ? '个人中心 > 我的订单' : data.site === 4 ? '个人中心 > 常用信息' : data.site === 5 ? '个人中心 > 我的账户 > 充值' : data.site === 6 ? '个人中心 > 我的账户' : data.site === 7 ? '个人中心 > 联系我们 > 我的建议' : data.site === 8 ? '对话流 > 帮助' : '无'}}</td>
                <td><img [src]="commonService.baseUrl.substring(0, commonService.baseUrl.indexOf('/admin')) + '/v1/cms/main-page-ads/images/' + data.image" class="thumbnail"></td>
                <td>{{data.displayMode === 'ONCE' ? '仅一次' : data.displayMode === 'EVERY_DAY' ? '每天展示N次' : data.displayMode === 'NO_MORE_AFTER_CHECK' ? '查看后不展示' : data.displayMode === 'EACH_START_UP' ? '每次启动出现' : 'null'}}</td>
                <td>
                  <nz-form-item>
                    <nz-form-control>
                      <nz-switch [(ngModel)]="data.enabled" (click)="clickSwitch(data, 'open')"></nz-switch>
                    </nz-form-control>
                  </nz-form-item>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModifyModal(data, 'open')" style="margin-right: 10px;"><i
                      class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showDeleteModal(data, 'open')" style="margin-right: 10px;"><i
                      class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹窗 —— 新增 —— 新增弹窗 -->
          <nz-modal [(nzVisible)]="visiable.addOpen" nzWidth="750" nzTitle="新增弹窗" [nzFooter]="addOpenModalFooter" (nzOnCancel)="hideAddModal('open')" nzMaskClosable="false">
            <form [formGroup]="addOpenForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>弹窗标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [(ngModel)]="openDate.title" placeholder="请输入弹窗标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="jump" [(ngModel)]="jumpForOpen">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="openDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row *ngIf="jumpForOpen === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="site" [ngModel]="1">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForOpen === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="openDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>展示规则：</div>
                <div nz-col nzSpan="16">
                  <nz-radio-group [(ngModel)]="displayModeForOpen" formControlName="displayModeForOpen">
                    <label nz-radio nzValue="ONCE">仅一次</label>
                    <label nz-radio nzValue="EVERY_DAY">每天展示N次</label>
                    <label nz-radio nzValue="NO_MORE_AFTER_CHECK">查看后不展示</label>
                    <label nz-radio nzValue="EACH_START_UP">每次启动出现</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row *ngIf="displayModeForOpen === 'EVERY_DAY'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>请输入展示次数：</div>
                <div nz-col nzSpan="11">
                  <input nz-input placeholder="请输入展示次数" formControlName="maxDisplay" nzSize="default">
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="1" class="right">次</div>
              </div>
              <!-- <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>排序状态：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="order" [(ngModel)]="openDate.order"
                    placeholder="请输入排序状态" nzSize="default">
                </div>
              </div> -->
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>弹窗图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：540*600&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length == 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img *ngIf="imageUrl" [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：540*600&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #addOpenModalFooter>
              <button nz-button nzType="primary" (click)="doSave('open')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideAddModal('open')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <!-- 弹窗 —— 修改 —— 修改弹窗 -->
          <nz-modal [(nzVisible)]="visiable.modifyOpen" nzWidth="750" nzTitle="修改弹窗" [nzFooter]="modifyOpenModalFooter" (nzOnCancel)="hideModifyModal('open')" nzMaskClosable="false">
            <form [formGroup]="modifyOpenForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>弹窗标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [ngModel]="openDate.title"
                    placeholder="请输入弹窗标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [(ngModel)]="openDate.jump" formControlName="jump">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="openDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row *ngIf="openDate.jump === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="openDate.site" formControlName="site">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="openDate.jump === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [ngModel]="openDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>展示规则：</div>
                <div nz-col nzSpan="16">
                  <nz-radio-group [(ngModel)]="displayModeForOpen" formControlName="displayModeForOpen">
                    <label nz-radio nzValue="ONCE">仅一次</label>
                    <label nz-radio nzValue="EVERY_DAY">每天展示N次</label>
                    <label nz-radio nzValue="NO_MORE_AFTER_CHECK">查看后不展示</label>
                    <label nz-radio nzValue="EACH_START_UP">每次启动出现</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row *ngIf="displayModeForOpen === 'EVERY_DAY'">
                <div nz-col nzSpan="8" class="right_alignment"><font color="red">*</font>请输入展示次数：</div>
                <div nz-col nzSpan="11">
                  <input nz-input formControlName="maxDisplay" [ngModel]="openDate.maxDisplay" placeholder="请输入展示次数" nzSize="default">
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="1" class="right">次</div>
              </div>
              <!-- <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>排序状态：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="order" [ngModel]="openDate.order"
                    placeholder="请输入排序状态" nzSize="default">
                </div>
              </div> -->
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>弹窗图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：540*600&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length === 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：540*600&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #modifyOpenModalFooter>
              <button nz-button nzType="primary" (click)="doModify('open')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModifyModal('open')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="bannerTemplate" (nzClick)="changePanel('banner')" *ngIf="commonService.haveMenuPermission('children', '轮播图')">
          <ng-template #bannerTemplate><i class="anticon anticon-picture"></i>轮播图</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showAddModal('banner')"><i class="anticon anticon-file-add"></i>新增轮播图</button>
            </div>
          </div>
          <nz-table nzBordered #bannerTable [nzData]="dataBanner" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>轮播图标题</th>
                <th>跳转位置</th>
                <th>到期时间</th>
                <th>链接地址</th>
                <th>APP标识</th>
                <th>排序状态</th>
                <th>轮播图片</th>
                <th>启用状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of bannerTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.title}}</td>
                <td>{{data.jump === 'DISABLED'? '不跳转' : data.jump === 'HTML' ? '跳转到网页' : '跳转到APP'}}</td>
                <td>{{data.expireTime}}</td>
                <td>{{data.url ? data.url !== '' ? data.url : '无' : '无'}}</td>
                <td>{{data.site === 1 ? '个人中心' : data.site === 2 ? '个人中心 > 设置' : data.site === 3 ? '个人中心 > 我的订单' : data.site === 4 ? '个人中心 > 常用信息' : data.site === 5 ? '个人中心 > 我的账户 > 充值' : data.site === 6 ? '个人中心 > 我的账户' : data.site === 7 ? '个人中心 > 联系我们 > 我的建议' : data.site === 8 ? '对话流 > 帮助' : '无'}}</td>
                <td>{{data.order}}</td>
                <td><img [src]="commonService.baseUrl.substring(0, commonService.baseUrl.indexOf('/admin')) + '/v1/cms/banner-ads/images/' + data.image" class="thumbnail"></td>
                <td>
                  <nz-form-item>
                    <nz-form-control>
                      <nz-switch [(ngModel)]="data.enabled" (click)="clickSwitch(data, 'banner')"></nz-switch>
                    </nz-form-control>
                  </nz-form-item>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModifyModal(data, 'banner')" style="margin-right: 10px;"><i
                      class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showDeleteModal(data, 'banner')" style="margin-right: 10px;"><i
                      class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹窗 —— 新增 —— 新增轮播图 -->
          <nz-modal [(nzVisible)]="visiable.addBanner" nzWidth="750" nzTitle="新增轮播图" [nzFooter]="addBannerModalFooter" (nzOnCancel)="hideAddModal('banner')" nzMaskClosable="false">
            <form [formGroup]="addBannerForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>轮播图标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [(ngModel)]="bannerDate.title"
                    placeholder="请输入轮播图标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="''" formControlName="jump" [(ngModel)]="jumpForBanner">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="bannerDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row *ngIf="jumpForBanner === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="site" [ngModel]="1">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForBanner === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="bannerDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>排序状态：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="order" [(ngModel)]="bannerDate.order"
                    placeholder="请输入排序状态" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>轮播图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length == 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img *ngIf="imageUrl" [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #addBannerModalFooter>
              <button nz-button nzType="primary" (click)="doSave('banner')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideAddModal('banner')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <!-- 弹窗 —— 修改 —— 修改轮播图 -->
          <nz-modal [(nzVisible)]="visiable.modifyBanner" nzWidth="750" nzTitle="修改轮播图" [nzFooter]="modifyBannerModalFooter" (nzOnCancel)="hideModifyModal('banner')" nzMaskClosable="false">
            <form [formGroup]="modifyBannerForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>轮播图标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [(ngModel)]="bannerDate.title" placeholder="请输入轮播图标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [(ngModel)]="bannerDate.jump" formControlName="jump">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="bannerDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row *ngIf="bannerDate.jump === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="bannerDate.site" formControlName="site">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="bannerDate.jump === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="bannerDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>排序状态：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="order" [(ngModel)]="bannerDate.order"
                    placeholder="请输入排序状态" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>弹窗图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length === 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #modifyBannerModalFooter>
              <button nz-button nzType="primary" (click)="doModify('banner')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModifyModal('banner')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="personalTemplate" (nzClick)="changePanel('personal')" *ngIf="commonService.haveMenuPermission('children', '个人中心')">
          <ng-template #personalTemplate><i class="anticon anticon-user"></i>个人中心</ng-template>
          <div nz-row>
            <div nz-col nzSpan="21"></div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showAddModal('personal')"><i class="anticon anticon-file-add"></i>新增广告图</button>
            </div>
          </div>
          <nz-table nzBordered #personalTable [nzData]="dataPersonal" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>个人中心图标</th>
                <th>跳转位置</th>
                <th>到期时间</th>
                <th>链接地址</th>
                <th>APP标识</th>
                <th>图片</th>
                <th>启用状态</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of personalTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.title}}</td>
                <td>{{data.jump === 'DISABLED'? '不跳转' : data.jump === 'HTML' ? '跳转到网页' : '跳转到APP'}}</td>
                <td>{{data.expireTime}}</td>
                <td>{{data.url ? data.url !== '' ? data.url : '无' : '无'}}</td>
                <td>{{data.site === 1 ? '个人中心' : data.site === 2 ? '个人中心 > 设置' : data.site === 3 ? '个人中心 > 我的订单' : data.site === 4 ? '个人中心 > 常用信息' : data.site === 5 ? '个人中心 > 我的账户 > 充值' : data.site === 6 ? '个人中心 > 我的账户' : data.site === 7 ? '个人中心 > 联系我们 > 我的建议' : data.site === 8 ? '对话流 > 帮助' : '无'}}</td>
                <td><img [src]="data.image" class="thumbnail"></td>
                <td>
                  <nz-form-item>
                    <nz-form-control>
                      <nz-switch [(ngModel)]="data.enabled" (click)="clickSwitch(data, 'personal')"></nz-switch>
                    </nz-form-control>
                  </nz-form-item>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModifyModal(data, 'personal')" style="margin-right: 10px;"><i
                      class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showDeleteModal(data, 'personal')" style="margin-right: 10px;"><i
                      class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <!-- 弹窗 —— 新增 —— 新增广告图 -->
          <nz-modal [(nzVisible)]="visiable.addPersonal" nzWidth="750" nzTitle="新增广告图" [nzFooter]="addPersonalModalFooter" (nzOnCancel)="hideAddModal('personal')" nzMaskClosable="false">
            <form [formGroup]="addPersonalForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>广告图标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [(ngModel)]="personalDate.title"
                    placeholder="请输入轮播图标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="''" formControlName="jump" [(ngModel)]="jumpForPersonal">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForPersonal === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select formControlName="site" [ngModel]="1">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="jumpForPersonal === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="personalDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="personalDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>广告图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length == 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img *ngIf="imageUrl" [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #addPersonalModalFooter>
              <button nz-button nzType="primary" (click)="doSave('personal')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideAddModal('personal')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <!-- 弹窗 —— 修改 —— 修改广告图 -->
          <nz-modal [(nzVisible)]="visiable.modifyPersonal" nzWidth="750" nzTitle="修改广告图" [nzFooter]="modifyPersonalModalFooter" (nzOnCancel)="hideModifyModal('personal')" nzMaskClosable="false">
            <form [formGroup]="modifyPersonalForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>广告图标题：
                </div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="title" [(ngModel)]="personalDate.title"
                    placeholder="请输入轮播图标题" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  <font color="red">*</font>跳转位置：
                </div>
                <div nz-col nzSpan="12">
                  <nz-select [(ngModel)]="personalDate.jump" formControlName="jump">
                    <nz-option required [nzLabel]="'不跳转'" [nzValue]="'DISABLED'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到网页'" [nzValue]="'HTML'"></nz-option>
                    <nz-option required [nzLabel]="'跳转到APP'" [nzValue]="'APP'"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="personalDate.jump === 'APP'">
                <div nz-col nzSpan="8" class="right_alignment">APP标识：</div>
                <div nz-col nzSpan="12">
                  <nz-select [ngModel]="personalDate.site" formControlName="site">
                    <nz-option required [nzLabel]="'个人中心'" [nzValue]="1"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 设置'" [nzValue]="2"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的订单'" [nzValue]="3"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 常用信息'" [nzValue]="4"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户 > 充值'" [nzValue]="5"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 我的账户'" [nzValue]="6"></nz-option>
                    <nz-option required [nzLabel]="'个人中心 > 联系我们 > 我的建议'" [nzValue]="7"></nz-option>
                    <nz-option required [nzLabel]="'对话流 > 帮助'" [nzValue]="8"></nz-option>
                  </nz-select>
                </div>
              </div>
              <div nz-row *ngIf="personalDate.jump === 'HTML'">
                <div nz-col nzSpan="8" class="right_alignment">链接地址：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="url" [(ngModel)]="personalDate.url"
                    placeholder="请输入链接地址" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">
                  到期时间：
                </div>
                <div nz-col nzSpan="12">
                  <nz-date-picker nzShowTime formControlName="expireTime" [(ngModel)]="personalDate.expireTime" required [nzFormat]="'yyyy-MM-dd HH:mm:ss'" nzPlaceHolder="请输入到期时间"></nz-date-picker>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment"><i class="anticon anticon-add"></i>
                  <font color="red">*</font>广告图片：
                </div>
                <div nz-col nzSpan="12">
                  <nz-upload [(nzFileList)]="fileList" [nzShowButton]="fileList.length < 1" nzMultiple [nzBeforeUpload]="beforeUpload">
                    <button nz-button>
                      <i class="anticon anticon-upload"></i><span>选择文件</span>
                    </button>
                    <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                  </nz-upload>
                </div>
              </div>
              <div nz-row *ngIf="fileList.length === 1">
                <div nz-col nzSpan="8" class="right_alignment"></div>
                <div nz-col nzSpan="12">
                  <img [src]="showImageUrl" class="image-panel">
                  <font color="#cccccc">&nbsp;&nbsp;建议尺寸：750*300&nbsp;&nbsp;限制大小：150K</font>
                </div>
              </div>
            </form>
            <!-- 弹窗和底部定制 -->
            <ng-template #modifyPersonalModalFooter>
              <button nz-button nzType="primary" (click)="doModify('personal')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModifyModal('personal')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

      </nz-tabset>
    </nz-card-tab>
  </nz-card>
</div>
