<app-left-nav></app-left-nav>
<div class="consumer" [ngStyle]="{'left': !commonService.isLeftNavClose ? 'calc(240px)' : 'calc(80px)','width': !commonService.isLeftNavClose ? 'calc(100% - 240px)' : 'calc(100% - 80px)'}">
  <nz-card>
    <nz-card-tab>
      <nz-tabset nzSize="large">

        <nz-tab [nzTitle]="consumerTemplate" (nzClick)="changePanel('consumer')" *ngIf="commonService.haveMenuPermission('children', '客户管理')">
          <ng-template #consumerTemplate><i class="anticon anticon-team"></i>客户管理</ng-template>
          <div nz-row>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="showModal('explain', '')"><i class="anticon anticon-question-circle-o"></i>数据说明</button>
            </div>
            <div nz-col nzSpan="2" class="right_alignment">是否作废：</div>
            <div nz-col nzSpan="2">
              <nz-select [(ngModel)]="consumerDate.available">
                <nz-option [nzLabel]="'全部'" [nzValue]="''"></nz-option>
                <nz-option [nzLabel]="'未作废'" [nzValue]="'true'"></nz-option>
                <nz-option [nzLabel]="'已作废'" [nzValue]="'false'"></nz-option>
              </nz-select>
            </div>
            <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
            <div nz-col nzSpan="3">
              <input nz-input [(ngModel)]="consumerDate.appChannel" placeholder="输入客户ID" nzSize="default" (keyup.enter)="loadData('consumer')">
            </div>
            <div nz-col nzSpan="2" class="right_alignment">客户名称：</div>
            <div nz-col nzSpan="3">
              <input nz-input [(ngModel)]="consumerDate.appChannelName" placeholder="输入客户名称" nzSize="default" (keyup.enter)="loadData('consumer')">
            </div>
            <div nz-col nzSpan="4"></div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('consumer')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="showModal('addConsumer', '')"><i class="anticon anticon-user-add"></i>新增客户</button>
            </div>
          </div>
          <nz-table nzBordered #consumerTable [nzData]="dataConsumer" *ngIf="!isSpinning" [nzScroll]="{x:'2100px'}" [(nzPageIndex)]="pageNum.dataConsumerPage">
            <thead>
              <tr>
                <th>序号</th>
                <th>客户ID</th>
                <th>客户名称</th>
                <th>APP key</th>
                <th>key类型</th>
                <th>后台校验</th>
                <th>APP Secret</th>
                <th>Client ID</th>
                <th>登录类型</th>
                <th>BOT名称</th>
                <th>激活次数</th>
                <th>Payment Key</th>
                <th>短信签名</th>
                <th>创建时间</th>
                <th>序列号</th>
                <th>对接凭证</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of consumerTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.appChannel}}</td>
                <td>{{data.appChannelName}}</td>
                <td>{{data.appKey}}</td>
                <td>{{data.officially === true ? '正式key' : '测试key'}}</td>
                <td>{{data.needGuestKey === false ? '不需要后台校验' : '需要后台校验'}}</td>
                <td>{{data.appSecret}}</td>
                <td>{{data.clientId}}</td>
                <td>{{data.loginType === 0 ? '不需要登录' : '需要登录'}}</td>
                <td>{{data.robot}}</td>
                <td>{{data.maxSnActivation}}</td>
                <td>{{data.paymentKey ? data.paymentKey : 'null'}}</td>
                <td>{{data.smsSignType ? data.smsSignType : 'null'}}</td>
                <td>{{data.createTime | date:'yyyy-MM-dd HH:mm:ss'}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('serialBatch', data)"><i class="anticon anticon-eye-o"></i>查看</button>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('voucher', data)"><i class="anticon anticon-eye-o"></i>查看</button>
                </td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('modifyConsumer', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>编辑</button>
                  <button nz-button nzType="primary" (click)="showModal('deleteConsumer', {event: $event, data: data})"><i class="anticon" [ngClass]="{'anticon-delete': data.available === true || data.available === undefined, 'anticon-poweroff': data.available === false}"></i>{{data.available === false ? '激活' : '作废'}}</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.modifyConsumer" nzWidth="950" nzTitle="修改客户信息" [nzFooter]="modifyConsumerModalFooter" (nzOnCancel)="hideModal('modifyConsumer')" nzMaskClosable="false">
            <form [formGroup]="modifyConsumerForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">key类型：</div>
                <div nz-col nzSpan="12">{{consumerDate.officially === true ? '正式key' : '测试key'}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">后台校验：</div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="needGuestKey" [(ngModel)]="consumerDate.needGuestKey">
                    <label nz-radio [nzValue]="true">需要后台校验</label>
                    <label nz-radio [nzValue]="false">不需要后台校验</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户ID：</div>
                <div nz-col nzSpan="12">{{consumerDate.appChannel}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户名称：</div>
                <div nz-col nzSpan="12">{{consumerDate.appChannelName}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">BOT配置文件ID：</div>
                <div nz-col nzSpan="12">{{consumerDate.robot}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户联系人手机号：</div>
                <div nz-col nzSpan="12">{{consumerDate.phone ? consumerDate.phone : '15111407234'}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">登录类型：</div>
                <div nz-col nzSpan="12">{{consumerDate.loginType === 1 ? '需要登录' : '不需要登录'}}</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">激活次数：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="maxSnActivation" [(ngModel)]="consumerDate.maxSnActivation" placeholder="请输入激活次数 Key" nzSize="default" *ngIf="consumerDate.officially === false">
                  {{consumerDate.officially === true ? '3' : ''}}
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">禁用短信通知 ：</div>
                <div nz-col nzSpan="12">默认需要订单短信服务，勾选后，表示不需要订单短信通知</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8"></div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="officially" [(ngModel)]="consumerDate.officially">
                    <label nz-col nzSpan="7" *ngFor="let data of dataMsgArr; let i=index;" nz-checkbox [(nzChecked)]="data.checked" (click)="onChange(data, 'msgArr')">{{ data.name }}</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">Payment Key：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="paymentKey" [(ngModel)]="consumerDate.paymentKey" placeholder="请输入Payment Key" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">短信签名：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="smsSign" [(ngModel)]="consumerDate.smsSign" placeholder="请输入短信签名" nzSize="default">
                </div>
              </div>
            </form>
            <ng-template #modifyConsumerModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyConsumer')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifyConsumer')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.addConsumer" nzWidth="950" nzTitle="新增客户信息" [nzFooter]="addConsumerModalFooter" (nzOnCancel)="hideModal('addConsumer')" nzMaskClosable="false">
            <form [formGroup]="addConsumerForm">
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">key类型 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="officially" [(ngModel)]="consumerDate.officially">
                    <label nz-radio [nzValue]="false">测试key</label>
                    <label nz-radio [nzValue]="true">正式key</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">后台校验 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="needGuestKey" [(ngModel)]="consumerDate.needGuestKey">
                    <label nz-radio [nzValue]="true">需要后台校验</label>
                    <label nz-radio [nzValue]="false">不需要后台校验</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户ID <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="appChannel" maxlength="32" [(ngModel)]="consumerDate.appChannel" placeholder="请输入客户ID（即appkey，长度不能超过32位）" nzSize="default">
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="1">
                  <button nz-button nzType="primary" (click)="showModal('explain', '')"><i class="anticon anticon-question-circle-o"></i></button>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户名称 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="appChannelName" [(ngModel)]="consumerDate.appChannelName" placeholder="请输入客户名称" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">BOT配置文件ID <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="robot" [(ngModel)]="consumerDate.robot" placeholder="请输入BOT配置文件id（不要填.yml文件后缀名）" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">客户联系人手机号 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="phone" [(ngModel)]="consumerDate.phone" placeholder="请输入手机号码（子账号默认手机号）" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">登录类型 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="aaa" [(ngModel)]="consumerDate.loginType">
                    <label nz-radio nzValue="1">需要登录</label>
                    <label nz-radio nzValue="0">不需要登录</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">激活次数 <font color="red">*</font>：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="maxSnActivation" [(ngModel)]="consumerDate.maxSnActivation" placeholder="请输入激活次数 Key" nzSize="default" *ngIf="consumerDate.officially === false">
                  {{consumerDate.officially === true ? '3' : ''}}
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">禁用短信通知 ：</div>
                <div nz-col nzSpan="12">默认需要订单短信服务，勾选后，表示不需要订单短信通知</div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8"></div>
                <div nz-col nzSpan="12">
                  <nz-radio-group formControlName="officially" [(ngModel)]="consumerDate.officially">
                    <label nz-col nzSpan="7" *ngFor="let data of dataMsgArr" nz-checkbox [(nzChecked)]="data.checked" (click)="onChange(data, 'msgArr')">{{ data.name }}</label>
                  </nz-radio-group>
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">Payment Key：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="paymentKey" [(ngModel)]="consumerDate.paymentKey" placeholder="请输入Payment Key" nzSize="default">
                </div>
              </div>
              <div nz-row>
                <div nz-col nzSpan="8" class="right_alignment">短信签名：</div>
                <div nz-col nzSpan="12">
                  <input nz-input formControlName="smsSign" [(ngModel)]="consumerDate.smsSign" placeholder="请输入短信签名" nzSize="default">
                </div>
              </div>
            </form>
            <ng-template #addConsumerModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addConsumer')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addConsumer')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.serialBatch" nzWidth="950" nzTitle="序列号批次" [nzFooter]="serialBatchModalFooter" (nzOnCancel)="hideModal('serialBatch')" nzMaskClosable="false">
            <form [formGroup]="serialBatchSearchForm">
              <div nz-row>
                <div nz-col nzSpan="3" class="right_alignment">序列号批次：</div>
                <div nz-col nzSpan="4">
                  <input nz-input formControlName="groupName" placeholder="请输入序列号批次" nzSize="default">
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="2">
                  <button nz-button nzType="primary" (click)="loadData('serialBatch')"><i class="anticon anticon-search"></i>查询</button>
                </div>
                <div nz-col nzSpan="11"></div>
                <div nz-col nzSpan="3">
                  <button nz-button nzType="primary" (click)="showModal('addSerialBatch')"><i class="anticon anticon-plus"></i>添加批次</button>
                </div>
              </div>
            </form>
            <nz-table nzBordered #serialBatchTable [nzData]="dataSerialBatch" *ngIf="!isSpinning">
              <thead>
                <tr>
                  <th>序号</th>
                  <th>批次名称</th>
                  <th>批次状态</th>
                  <th>测试时间</th>
                  <th>序列号数量</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of serialBatchTable.data; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.name}}</td>
                  <td>{{data.type === 'TEST' ? '测试' : '正式'}}</td>
                  <td>{{data.testStartDate | date:'yyyyMMdd'}}-{{data.testEndDate | date:'yyyyMMdd'}}</td>
                  <td>{{data.keyCount}}</td>
                  <td>
                    <button nz-button nzType="primary" (click)="showModal('modifySerialBatch', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>修改</button>
                    <button nz-button nzType="primary" (click)="showModal('modifySerial', data)"><i class="anticon anticon-plus"></i>添加序列号</button>
                  </td>
                </tr>
              </tbody>
            </nz-table>
            <ng-template #serialBatchModalFooter>
              <div nz-row>
                <div nz-col nzSpan="3">客户ID：</div>
                <div nz-col nzSpan="5" class="left_alignment">{{serialBatchData.appChannel}}</div>
                <div nz-col nzSpan="2">客户名称：</div>
                <div nz-col nzSpan="3" class="left_alignment">{{serialBatchData.appChannelName}}</div>
                <div nz-col nzSpan="3">序列号数量：</div>
                <div nz-col nzSpan="1" class="left_alignment">{{dataSerialBatch.length}}</div>
                <div nz-col nzSpan="2">激活次数：</div>
                <div nz-col nzSpan="2" class="left_alignment">{{serialBatchData.maxSnActivation}}</div>
              </div>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.addSerialBatch" nzWidth="750" nzTitle="新增序列号批次" [nzFooter]="addSerialBatchModalFooter" (nzOnCancel)="hideModal('addSerialBatch')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">批次名称：</div>
              <div nz-col nzSpan="18">
                <input nz-input [(ngModel)]="serialBatchData.name" placeholder="请输入批次名称" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">批次状态：</div>
              <div nz-col nzSpan="20">
                <nz-radio-group [(ngModel)]="serialBatchData.type">
                  <label nz-radio [nzValue]="'TEST'">测试key</label>
                  <label nz-radio [nzValue]="'FORMAL'">正式key</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">测试时间：</div>
              <div nz-col nzSpan="20">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'serialBatch')"></nz-range-picker>
              </div>
            </div>
            <ng-template #addSerialBatchModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addSerialBatch')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addSerialBatch')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifySerialBatch" nzWidth="750" nzTitle="修改序列号批次" [nzFooter]="modifySerialBatchModalFooter" (nzOnCancel)="hideModal('modifySerialBatch')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">批次名称：</div>
              <div nz-col nzSpan="18">
                <input nz-input [(ngModel)]="serialBatchData.name" placeholder="请输入批次名称" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">批次状态：</div>
              <div nz-col nzSpan="20">
                <nz-radio-group [(ngModel)]="serialBatchData.type">
                  <label nz-radio [nzValue]="'TEST'">测试key</label>
                  <label nz-radio [nzValue]="'FORMAL'">正式key</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="4" class="right_alignment">测试时间：</div>
              <div nz-col nzSpan="20">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" [(ngModel)]="dateRange" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'serialBatch')"></nz-range-picker>
              </div>
            </div>
            <ng-template #modifySerialBatchModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifySerialBatch')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifySerialBatch')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifySerial" nzWidth="950" nzTitle="序列号" [nzFooter]="modifySerialModalFooter" (nzOnCancel)="hideModal('modifySerial')" nzMaskClosable="false">
            <form [formGroup]="serialSearchForm">
              <div nz-row>
                <div nz-col nzSpan="2" class="right_alignment">序列号：</div>
                <div nz-col nzSpan="4">
                  <input nz-input formControlName="sn" placeholder="请输入序列号" nzSize="default">
                </div>
                <div nz-col nzSpan="1"></div>
                <div nz-col nzSpan="2">
                  <button nz-button nzType="primary" (click)="loadData('modifySerial')"><i class="anticon anticon-search"></i>查询</button>
                </div>
                <div nz-col nzSpan="9"></div>
                <div nz-col nzSpan="3">
                  <button nz-button nzType="primary" (click)="showModal('deleteSerialM')"><i class="anticon anticon-delete"></i>批量删除</button>
                </div>
                <div nz-col nzSpan="3">
                  <button nz-button nzType="primary" (click)="showModal('addSerial')"><i class="anticon anticon-plus"></i>添加序列号</button>
                </div>
              </div>
            </form>
            <nz-table nzBordered #consumerTable [nzData]="dataSerial" *ngIf="!isSpinning">
              <thead>
                <tr>
                  <th>序号</th>
                  <th>序列号</th>
                  <th>已激活次数</th>
                  <th>操作</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of consumerTable.data; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.sn}}</td>
                  <td>{{data.count}}</td>
                  <td>
                    <button nz-button nzType="primary" (click)="showModal('deleteSerial', data.id)"><i class="anticon anticon-delete"></i>删除</button>
                  </td>
                </tr>
              </tbody>
            </nz-table>
            <ng-template #modifySerialModalFooter>
              <div nz-row>
                <div nz-col nzSpan="3">客户ID：</div>
                <div nz-col nzSpan="5" class="left_alignment">{{serialBatchData.appChannel}}</div>
                <div nz-col nzSpan="2">客户名称：</div>
                <div nz-col nzSpan="3" class="left_alignment">{{serialBatchData.appChannelName}}</div>
                <div nz-col nzSpan="3">序列号数量：</div>
                <div nz-col nzSpan="1" class="left_alignment">{{dataSerial.length}}</div>
                <div nz-col nzSpan="2">激活次数：</div>
                <div nz-col nzSpan="2" class="left_alignment">{{serialBatchData.maxSnActivation}}</div>
              </div>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.addSerial" nzWidth="950" nzTitle="添加序列号" [nzFooter]="addSerialModalFooter" (nzOnCancel)="hideModal('addSerial')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24">可以输入或上传文件添加序列号，添加前请务必检查序列号是否正确</div>
            </div><div nz-row>
              <div nz-col nzSpan="24">
                <textarea rows="25" nz-input [(ngModel)]="consumerDate.keys" nzSize="default"></textarea>
              </div>
              <div nz-col nzSpan="3">
                <a href="javascript:;" class="a-upload"><i class="anticon anticon-upload"></i>上传文件
                  <input type="file" (change)="getExcel($event)" multiple="false" />
                </a>
              </div>
              <div nz-col nzSpan="6" style="margin-top: 15px;">支持.CSV，.xls，.xlsx</div>
            </div>
            <ng-template #addSerialModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addSerial')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addSerial')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.deleteSerial" nzWidth="950" nzTitle="批量删除序列号" [nzFooter]="deleteSerialModalFooter" (nzOnCancel)="hideModal('deleteSerialM')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24">可以输入或上传文件添加序列号，添加前请务必检查序列号是否正确</div>
            </div><div nz-row>
              <div nz-col nzSpan="24">
                <textarea rows="25" nz-input [(ngModel)]="consumerDate.keys" nzSize="default"></textarea>
              </div>
              <div nz-col nzSpan="3">
                <a href="javascript:;" class="a-upload"><i class="anticon anticon-upload"></i>上传文件
                  <input type="file" (change)="getExcel($event)" multiple="false" />
                </a>
              </div>
              <div nz-col nzSpan="6" style="margin-top: 15px;">支持.CSV，.xls，.xlsx</div>
            </div>
            <ng-template #deleteSerialModalFooter>
              <button nz-button nzType="primary" (click)="showModal('deleteSerialBatch', '')"><i class="anticon anticon-delete"></i>确定</button>
              <button nz-button nzType="default" (click)="hideModal('deleteSerialM')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.deleteSerialResult" nzWidth="950" nzTitle="批量删除结果" [nzFooter]="null" (nzOnCancel)="hideModal('deleteSerialResult')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="12" style="text-align: center;">删除成功序列号</div>
              <div nz-col nzSpan="12" style="text-align: center;">删除失败序列号</div>
            </div><div nz-row>
              <div nz-col nzSpan="11">
                <textarea rows="25" nz-input disabled [(ngModel)]="deleteSerialResult.successSns" nzSize="default"></textarea>
              </div>
              <div nz-col nzSpan="2"></div>
              <div nz-col nzSpan="11">
                <textarea rows="25" nz-input disabled [(ngModel)]="deleteSerialResult.failSns" nzSize="default"></textarea>
              </div>
            </div>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.voucher" nzTitle="对接凭证" [nzFooter]="voucherModalFooter" (nzOnCancel)="hideModal('voucher')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24">【appChannel/appKey】{{voucherInfo.appChannel}}</div>
              <div nz-col nzSpan="24">【appSecret】{{voucherInfo.appSecret}}</div>
              <div nz-col nzSpan="24">【aesKey】{{voucherInfo.aesKey}}</div>
              <div nz-col nzSpan="24">【aesIv】{{voucherInfo.aesIv}}</div>
              <div nz-col nzSpan="24">【privateKey】{{voucherInfo.privateKey}}</div>
            </div>
            <ng-template #voucherModalFooter>
              <button nz-button nzType="primary" (click)="doSave('voucher')"><i class="anticon anticon-copy"></i>复制</button>
              <button nz-button nzType="default" (click)="hideModal('voucher')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.explain" nzWidth="1110" nzTitle="客户管理数据说明" [nzFooter]="explainModalFooter" (nzOnCancel)="hideModal('explain')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="24"><img [src]="'assets/images/consumer_explain.png'"></div>
            </div>
            <ng-template #explainModalFooter>
              <button nz-button nzType="default" (click)="hideModal('explain')"><i class="anticon anticon-close-circle-o"></i>关闭</button>
            </ng-template>
          </nz-modal>

        </nz-tab>

        <nz-tab [nzTitle]="callbackTemplate" (nzClick)="changePanel('callback')" *ngIf="commonService.haveMenuPermission('children', '订单回调地址')">
          <ng-template #callbackTemplate><i class="anticon anticon-rollback"></i>回调地址</ng-template>
          <div nz-row>
            <form [formGroup]="callbackSearchForm">
              <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户ID" formControlName="appChannel" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">订单类型：</div>
              <div nz-col nzSpan="3">
                <nz-select [ngModel]="''" formControlName="orderType">
                  <nz-option [nzLabel]="'全部'" [nzValue]="''"></nz-option>
                  <nz-option [nzLabel]="'火车'" [nzValue]="'TRAIN_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'机票'" [nzValue]="'FLIGHT_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'酒店'" [nzValue]="'HOTEL_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'打车'" [nzValue]="'TAXI_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'闪送'" [nzValue]="'EXPRESS_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'充话费'" [nzValue]="'PHONE_CHARGE_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'电影票'" [nzValue]="'MOVIE_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'恋爱运势'" [nzValue]="'PAIR_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'月运势'" [nzValue]="'FORTUNE_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'付费音频'" [nzValue]="'MUSIC_ORDER'"></nz-option>
                  <nz-option [nzLabel]="'交游天下游戏'" [nzValue]="'JIAOYOU_GAME_ORDER'"></nz-option>
                </nz-select>
              </div>
            </form>
            <div nz-col nzSpan="9"></div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('callback')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showModal('addCallback', data)"><i class="anticon anticon-file-add"></i>新增回调地址</button>
            </div>
          </div>
          <nz-table nzBordered #callbackTable [nzData]="dataCallback" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>客户ID</th>
                <th>订单类型</th>
                <th>回调地址</th>
                <th>创建时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of callbackTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.appChannel}}</td>
                <td>{{data.orderType === 'TRAIN_ORDER' ? '火车' : data.orderType === 'FLIGHT_ORDER' || data.orderType === 'FLIGHT_RETURN_ORDER' ? '机票' : data.orderType === 'HOTEL_ORDER' ? '酒店' : data.orderType === 'TAXI_ORDER' ? '打车' : data.orderType === 'EXPRESS_ORDER' ? '闪送' : data.orderType === 'PHONE_CHARGE_ORDER' ? '充话费' : data.orderType === 'MOVIE_ORDER' ? '电影票' : data.orderType === 'PAIR_ORDER' ? '恋爱运势' : data.orderType === 'FORTUNE_ORDER' ? '月运势' : data.orderType === 'MUSIC_ORDER' ? '付费音频' : data.orderType === 'JIAOYOU_GAME_ORDER' ? '交游天下游戏' : ''}}</td>
                <td>{{data.callbackUrl}}</td>
                <td>{{data.createTime ? (data.createTime | date:'yyyy-MM-dd HH:mm:ss') : null}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('modifyCallback', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showModal('deleteCallback', data.id)"><i class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.addCallback" nzTitle="新增回调地址" nzWidth="850" [nzFooter]="addCallbackModalFooter" (nzOnCancel)="hideModal('addCallback')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">
                <ng-container *ngIf="dataConsumer.length === 0">没有新客户ID需要配置</ng-container>
                <ng-container *ngIf="dataConsumer.length > 0">
                  <nz-radio-group [(ngModel)]="callbackData.appChannel">
                    <ng-container *ngFor="let data of dataConsumer;">
                      <label nz-col nzSpan="11" nz-radio [nzValue]="data.appChannel" (click)="onChange(data, 'appChannel')">{{data.appChannel}}</label>
                    </ng-container>
                  </nz-radio-group>
                </ng-container>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">订单类型：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="callbackData.orderType">
                  <ng-container *ngFor="let data of orderTypeItem; let i=index;">
                    <label nz-col nzSpan="5" *ngIf="data.visiable === true" nz-radio [nzValue]="data.key">{{data.value}}</label>
                  </ng-container>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">回调地址：</div>
              <div nz-col nzSpan="19">
                <input nz-input placeholder="请输入回调地址" [(ngModel)]="callbackData.callbackUrl" nzSize="default">
              </div>
            </div>
            <ng-template #addCallbackModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addCallback')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addCallback')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifyCallback" nzTitle="修改回调地址" [nzFooter]="modifyCallbackModalFooter" (nzOnCancel)="hideModal('modifyCallback')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">{{callbackData.appChannel}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">订单类型：</div>
              <div nz-col nzSpan="19">
                {{callbackData.orderType === 'TRAIN_ORDER' ? '火车' : callbackData.orderType === 'FLIGHT_ORDER' || callbackData.orderType === 'FLIGHT_RETURN_ORDER' ? '机票' : callbackData.orderType === 'HOTEL_ORDER' ? '酒店' : callbackData.orderType === 'TAXI_ORDER' ? '打车' : callbackData.orderType === 'EXPRESS_ORDER' ? '闪送' : callbackData.orderType === 'PHONE_CHARGE_ORDER' ? '充话费' : callbackData.orderType === 'MOVIE_ORDER' ? '电影票' : callbackData.orderType === 'PAIR_ORDER' ? '恋爱运势' : callbackData.orderType === 'FORTUNE_ORDER' ? '月运势' : callbackData.orderType === 'MUSIC_ORDER' ? '付费音频' : callbackData.orderType === 'JIAOYOU_GAME_ORDER' ? '交游天下游戏' : ''}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">回调地址：</div>
              <div nz-col nzSpan="19">
                <input nz-input placeholder="请输入回调地址" [(ngModel)]="callbackData.callbackUrl" nzSize="default">
              </div>
            </div>
            <ng-template #modifyCallbackModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyCallback')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifyCallback')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>


        <nz-tab [nzTitle]="musicTemplate" (nzClick)="changePanel('music')" *ngIf="commonService.haveMenuPermission('children', '订单回调地址')">
          <ng-template #musicTemplate><i class="anticon anticon-sound"></i>音频管理</ng-template>
          <div nz-row>
            <form [formGroup]="musicSearchForm">
              <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户ID" formControlName="appChannel" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">客户名称：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户名称" formControlName="aaa" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">创建时间：</div>
              <div nz-col nzSpan="7">
                <nz-range-picker [nzFormat]="'yyyyMMdd'" formControlName="date" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'music')"></nz-range-picker>
              </div>
            </form>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('music')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showModal('addMusic', data)"><i class="anticon anticon-file-add"></i>新增配置</button>
            </div>
          </div>
          <nz-table nzBordered #musicTable [nzData]="dataMusic" *ngIf="!isSpinning">
            <thead>
              <tr>
                <th>序号</th>
                <th>客户ID</th>
                <th>客户名称</th>
                <th>接入SDK</th>
                <th>是否小悟</th>
                <th>音乐</th>
                <th>懒人听书</th>
                <th>口袋故事</th>
                <th>喜马拉雅</th>
                <th>创建时间</th>
                <th>操作人</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of musicTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.appChannel}}</td>
                <td>{{data.customerName}}</td>
                <td>{{data.useSDK === true ? '是' : '否'}}</td>
                <td>{{data.xiaoWu === true ? '是' : '否'}}</td>
                <td>{{data.musicAccess === true ? '是' : '否'}}</td>
                <td>{{data.lanRenAccess === true ? '是' : '否'}}</td>
                <td>{{data.koudaiAccess === true ? '是' : '否'}}</td>
                <td>{{data.xmlyAccess === true ? '是' : '否'}}</td>
                <td>{{data.createTime && data.createTime !== 'null' ? (data.createTime | date:'yyyy-MM-dd HH:mm:ss') : null}}</td>
                <td>{{data.operator}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('modifyMusic', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showModal('deleteMusic', data.appChannel)"><i class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.addMusic" nzTitle="新增配置" [nzFooter]="addMusicModalFooter" (nzOnCancel)="hideModal('addMusic')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">
                  <input nz-input placeholder="请输入客户ID" [(ngModel)]="musicData.appChannel" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">接入SDK：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="musicData.useSDK">
                    <label nz-col nzSpan="10" nz-radio [nzValue]="true">是</label>
                    <label nz-col nzSpan="10" nz-radio [nzValue]="false">否</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">是否小悟：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="musicData.xiaoWu">
                    <label nz-col nzSpan="10" nz-radio [nzValue]="true">是</label>
                    <label nz-col nzSpan="10" nz-radio [nzValue]="false">否</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">音频资源：</div>
              <label nz-col nzSpan="9" nz-checkbox [(ngModel)]="musicData.musicAccess">音乐</label>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.lanRenAccess">懒人听书</label>
            </div>
            <div nz-row>
                <div nz-col nzSpan="5"></div>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.koudaiAccess">口袋故事</label>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.xmlyAccess">喜马拉雅</label>
            </div>
            <ng-template #addMusicModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addMusic')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addMusic')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifyMusic" nzTitle="修改配置" [nzFooter]="modifyMusicModalFooter" (nzOnCancel)="hideModal('modifyMusic')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">{{musicData.appChannel}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">接入SDK：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="musicData.useSDK">
                    <label nz-col nzSpan="10" nz-radio [nzValue]="true">是</label>
                    <label nz-col nzSpan="10" nz-radio [nzValue]="false">否</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">是否小悟：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="musicData.xiaoWu">
                    <label nz-col nzSpan="10" nz-radio [nzValue]="true">是</label>
                    <label nz-col nzSpan="10" nz-radio [nzValue]="false">否</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">音频资源：</div>
              <label nz-col nzSpan="9" nz-checkbox [(ngModel)]="musicData.musicAccess">音乐</label>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.lanRenAccess">懒人听书</label>
            </div>
            <div nz-row>
                <div nz-col nzSpan="5"></div>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.koudaiAccess">口袋故事</label>
              <label nz-col nzSpan="9" nz-checkbox [(nzChecked)]="musicData.xmlyAccess">喜马拉雅</label>
            </div>
            <ng-template #modifyMusicModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyMusic')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifyMusic')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>


        <nz-tab [nzTitle]="bluetoothTemplate" (nzClick)="changePanel('bluetooth')" *ngIf="commonService.haveMenuPermission('children', '订单回调地址')">
          <ng-template #bluetoothTemplate><i class="anticon anticon-disconnect"></i>蓝牙设备</ng-template>
          <div nz-row>
            <form [formGroup]="bluetoothSearchForm">
              <div nz-col nzSpan="2" class="right_alignment">客户名称：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户名称" formControlName="customerName" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">设备类型：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入设备类型" formControlName="deviceType" nzSize="default">
              </div>
            </form>
            <div nz-col nzSpan="9"></div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('bluetooth')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showModal('addBluetooth', data)"><i class="anticon anticon-file-add"></i>新增设备</button>
            </div>
          </div>
          <nz-table nzBordered #bluetoothTable [nzData]="dataBluetooth" *ngIf="!isSpinning" [nzScroll]="{x:'2100px'}">
            <thead>
              <tr>
                <th>序号</th>
                <th>客户名称</th>
                <th>设备类型</th>
                <th>设备key</th>
                <th>logo</th>
                <th>功能说明</th>
                <th>功能Icon1</th>
                <th>功能Icon2</th>
                <th>功能Icon3</th>
                <th>是否支持BLE</th>
                <th>创建时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of bluetoothTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.customerName}}</td>
                <td>{{data.deviceType}}</td>
                <td>{{data.deviceKey}}</td>
                <td><img *ngIf="data.logo && data.logo" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + data.logo" class="image-panel"></td>
                <td>{{data.functionDesc}}</td>
                <td><img *ngIf="data.deviceIcon1 && data.deviceIcon1" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + data.deviceIcon1" class="image-panel"></td>
                <td><img *ngIf="data.deviceIcon2 && data.deviceIcon2" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + data.deviceIcon2" class="image-panel"></td>
                <td><img *ngIf="data.deviceIcon3 && data.deviceIcon3" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + data.deviceIcon3" class="image-panel"></td>
                <td>{{data.supportBle === true ? '支持' : '不支持'}}</td>
                <td>{{data.createTime | date:'yyyy-MM-dd HH:mm:ss':'GMT+16:00'}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('modifyBluetooth', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showModal('deleteBluetooth', data.id)"><i class="anticon anticon-delete"></i>删除</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.addBluetooth" nzWidth="950" nzTitle="新增设备" [nzFooter]="addBluetoothModalFooter" (nzOnCancel)="hideModal('addBluetooth')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户名称：</div>
              <div nz-col nzSpan="19">
                  <input nz-input placeholder="请输入客户名称" [(ngModel)]="bluetoothData.customerName" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">设备类型：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="bluetoothData.deviceType">
                  <label nz-col *ngFor="let item of bluetoothData.deviceTypeList" nzSpan="10" nz-radio [nzValue]="item.deviceName">{{item.deviceName}}</label>
                  <label nz-col nzSpan="10" nz-radio [nzValue]="'new'">新增设备类型</label>
                </nz-radio-group>
                <input nz-input *ngIf="bluetoothData.deviceType === 'new'" placeholder="请输入新的设备类型" [(ngModel)]="bluetoothData.newDeviceType" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">支持BLE：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="bluetoothData.supportBle">
                    <label nz-col nzSpan="10" nz-radio [nzValue]="true">支持</label>
                    <label nz-col nzSpan="10" nz-radio [nzValue]="false">不支持</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">设备logo：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileLogo" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('logo')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileLogo.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.logo" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.logo" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon1：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon1" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon1')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon1.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon1" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon1" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon2：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon2" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon2')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon2.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon2" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon2" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon3：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon3" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon3')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon3.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon3" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon3" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能说明：</div>
              <div nz-col nzSpan="19">
                <textarea rows="5" nz-input placeholder="请输入功能说明，选填" [(ngModel)]="bluetoothData.functionDesc" nzSize="default"></textarea>
              </div>
            </div>
            <ng-template #addBluetoothModalFooter>
              <button nz-button nzType="primary" (click)="doSave('addBluetooth')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addBluetooth')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifyBluetooth" nzWidth="950" nzTitle="修改设备" [nzFooter]="modifyBluetoothModalFooter" (nzOnCancel)="hideModal('modifyBluetooth')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户名称：</div>
              <div nz-col nzSpan="19">
                {{bluetoothData.customerName}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">设备类型：</div>
              <div nz-col nzSpan="19">
                {{bluetoothData.deviceType}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">支持BLE：</div>
              <div nz-col nzSpan="19">
                {{bluetoothData.supportBle && bluetoothData.supportBle === true ? '支持' : '不支持'}}
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">设备logo：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileLogo" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('logo')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileLogo.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.logo" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.logo" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon1：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon1" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon1')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon1.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon1" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon1" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon2：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon2" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon2')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon2.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon2" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon2" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能Icon3：</div>
              <div nz-col nzSpan="19">
                <nz-upload [(nzFileList)]="bluetoothData.fileIcon3" nzMultiple [nzBeforeUpload]="beforeUpload">
                  <button nz-button nzType="primary" (click)="choosePng('icon3')">
                    <i class="anticon anticon-upload"></i><span>上传文件</span>
                  </button>
                  &nbsp;&nbsp支持.jpg .png
                </nz-upload>
              </div>
            </div>
            <div nz-row *ngIf="bluetoothData.fileIcon3.length == 1">
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="19">
                <img *ngIf="bluetoothData.deviceIcon3" [src]="this.commonService.baseUrl.substring(0, this.commonService.baseUrl.indexOf('/admin')) + '/cms/bluetooth/images/' + bluetoothData.deviceIcon3" class="image-panel">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">功能说明：</div>
              <div nz-col nzSpan="19">
                <textarea rows="5" nz-input placeholder="请输入功能说明，选填" [(ngModel)]="bluetoothData.functionDesc" nzSize="default"></textarea>
              </div>
            </div>
            <ng-template #modifyBluetoothModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyBluetooth')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifyBluetooth')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

        </nz-tab>


        <nz-tab [nzTitle]="accountTemplate" (nzClick)="changePanel('account')" *ngIf="commonService.haveMenuPermission('children', '订单回调地址')">
          <ng-template #accountTemplate><i class="anticon anticon-wallet"></i>客户账户</ng-template>
          <div nz-row>
            <form [formGroup]="accountSearchForm">
              <div nz-col nzSpan="2" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户ID" formControlName="customerId" nzSize="default">
              </div>
              <div nz-col nzSpan="2" class="right_alignment">客户名称：</div>
              <div nz-col nzSpan="3">
                <input nz-input placeholder="请输入客户名称" formControlName="customerName" nzSize="default">
              </div>
            </form>
            <div nz-col nzSpan="9"></div>
            <div nz-col nzSpan="2">
              <button nz-button nzType="primary" (click)="loadData('account')"><i class="anticon anticon-search"></i>查询</button>
            </div>
            <div nz-col nzSpan="3">
              <button nz-button nzType="primary" (click)="showModal('addAccount', data)"><i class="anticon anticon-file-add"></i>新增账户</button>
            </div>
          </div>
          <nz-table nzBordered #accountTable [nzData]="dataAccount" *ngIf="!isSpinning" [nzScroll]="{x:'2100px'}">
            <thead>
              <tr>
                <th>序号</th>
                <th>客户ID</th>
                <th>客户名称</th>
                <th>账户余额</th>
                <th>最近充值</th>
                <th>最近充值时间</th>
                <th>联系邮箱</th>
                <th>创建人</th>
                <th>创建时间</th>
                <th>操作</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let data of accountTable.data; let i=index;">
                <td>{{i+1}}</td>
                <td>{{data.customerId}}</td>
                <td>{{data.customerName}}</td>
                <td>{{data.accountBalance}}</td>
                <td>{{data.latestRecharge}}</td>
                <td>{{data.latestRechargeTime | date:'yyyy-MM-dd HH:mm:ss':'GMT+16:00'}}</td>
                <td>{{data.email}}</td>
                <td>{{data.operator}}</td>
                <td>{{data.createTime | date:'yyyy-MM-dd HH:mm:ss':'GMT+16:00'}}</td>
                <td>
                  <button nz-button nzType="primary" (click)="showModal('modifyAccount', data)" style="margin-right: 10px"><i class="anticon anticon-form"></i>修改</button>
                  <button nz-button nzType="primary" (click)="showModal('recharge', data)" style="margin-right: 10px"><i class="anticon anticon-delete"></i>充值</button>
                  <button nz-button nzType="primary" (click)="showModal('capital', data)"><i class="anticon anticon-delete"></i>资金流水</button>
                </td>
              </tr>
            </tbody>
          </nz-table>
          <div class="spin" *ngIf="isSpinning">
            <nz-spin [nzSize]="'large'"></nz-spin>
          </div>

          <nz-modal [(nzVisible)]="visiable.addAccount" nzWidth="950" nzTitle="新增账户" [nzFooter]="addAccountModalFooter" (nzOnCancel)="hideModal('addAccount')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">
                <nz-radio-group [(ngModel)]="accountData.customerId">
                  <label nz-col *ngFor="let item of accountData.customerIds" nzSpan="10" nz-radio [nzValue]="item">{{item}}</label>
                </nz-radio-group>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">联系邮箱：</div>
              <div nz-col nzSpan="10">
                  <input nz-input placeholder="请输入联系邮箱" [(ngModel)]="accountData.email" nzSize="default">
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="8">邮箱必填，可以及时通知用户账号的变动</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">余额阈值：</div>
              <div nz-col nzSpan="10">
                <input nz-input placeholder="请输入余额阈值" [(ngModel)]="accountData.balanceThresholds" nzSize="default">
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="1">元</div>
              <div nz-col nzSpan="7">当余额低于设置的阈值时，则发邮件给该客户</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">验证码：</div>
              <div nz-col nzSpan="3">
                <nz-select [(ngModel)]="accountData.phoneNum">
                  <nz-option required [nzLabel]="'18682233554'" [nzValue]="'18682233554'"></nz-option>
                  <nz-option required [nzLabel]="'18665310035'" [nzValue]="'18665310035'"></nz-option>
                  <nz-option required [nzLabel]="'18516609441'" [nzValue]="'18516609441'"></nz-option>
                  <nz-option required [nzLabel]="'18682251210'" [nzValue]="'18682251210'"></nz-option>
                  <nz-option required [nzLabel]="'18819448274'" [nzValue]="'18819448274'"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="3">
                <button nz-button nzType="primary" (click)="doSave('sendMsg')" [disabled]="accountData.countDown !== 60">{{accountData.countDown === 60 ? '获取验证码' : accountData.countDown + 's'}}</button>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="3">
                <input nz-input nzSize="default" placeholder="请输入验证码" [(ngModel)]="accountData.code">
              </div>
            </div>
            <ng-template #addAccountModalFooter>
                <!-- [disabled]="accountData.code.length !== 4" -->
              <button nz-button nzType="primary" (click)="doSave('addAccount')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('addAccount')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.modifyAccount" nzWidth="950" nzTitle="修改账户" [nzFooter]="modifyAccountModalFooter" (nzOnCancel)="hideModal('modifyAccount')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">{{accountData.customerId}}</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">联系邮箱：</div>
              <div nz-col nzSpan="10">
                  <input nz-input placeholder="请输入联系邮箱" [(ngModel)]="accountData.email" nzSize="default">
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="8">邮箱必填，可以及时通知用户账号的变动</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">余额阈值：</div>
              <div nz-col nzSpan="10">
                <input nz-input placeholder="请输入余额阈值" [(ngModel)]="accountData.balanceThresholds" nzSize="default">
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="1">元</div>
              <div nz-col nzSpan="7">当余额低于设置的阈值时，则发邮件给该客户</div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">验证码：</div>
              <div nz-col nzSpan="3">
                <nz-select [(ngModel)]="accountData.phoneNum">
                  <nz-option required [nzLabel]="'18682233554'" [nzValue]="'18682233554'"></nz-option>
                  <nz-option required [nzLabel]="'18665310035'" [nzValue]="'18665310035'"></nz-option>
                  <nz-option required [nzLabel]="'18516609441'" [nzValue]="'18516609441'"></nz-option>
                  <nz-option required [nzLabel]="'18682251210'" [nzValue]="'18682251210'"></nz-option>
                  <nz-option required [nzLabel]="'18819448274'" [nzValue]="'18819448274'"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="3">
                <button nz-button nzType="primary" (click)="doSave('sendMsg')" [disabled]="accountData.countDown !== 60">{{accountData.countDown === 60 ? '获取验证码' : accountData.countDown + 's'}}</button>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="3">
                <input nz-input nzSize="default" placeholder="请输入验证码" [(ngModel)]="accountData.code">
              </div>
            </div>
            <ng-template #modifyAccountModalFooter>
              <button nz-button nzType="primary" (click)="doSave('modifyAccount')"><i class="anticon anticon-save"></i>保存</button>
              <button nz-button nzType="default" (click)="hideModal('modifyAccount')"><i class="anticon anticon-close-circle-o"></i>取消</button>
            </ng-template>
          </nz-modal>

          <nz-modal [(nzVisible)]="visiable.recharge" nzWidth="750" nzTitle="充值" [nzFooter]="rechargeModalFooter" (nzOnCancel)="hideModal('recharge')" nzMaskClosable="false">
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">客户ID：</div>
              <div nz-col nzSpan="19">{{accountData.customerId}}</div>
            </div>
            <div nz-row>
                <div nz-col nzSpan="5" class="right_alignment">账户余额：</div>
                <div nz-col nzSpan="19">{{accountData.accountBalance}}</div>
              </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">账户充值：</div>
              <div nz-col nzSpan="19">
                <input nz-input placeholder="请输入钱包金额，单位元" [(ngModel)]="accountData.recharge" nzSize="default">
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5" class="right_alignment">验证码：</div>
              <div nz-col nzSpan="3">
                <nz-select [(ngModel)]="accountData.phoneNum">
                  <nz-option required [nzLabel]="'18682233554'" [nzValue]="'18682233554'"></nz-option>
                  <nz-option required [nzLabel]="'18665310035'" [nzValue]="'18665310035'"></nz-option>
                  <nz-option required [nzLabel]="'18516609441'" [nzValue]="'18516609441'"></nz-option>
                  <nz-option required [nzLabel]="'18682251210'" [nzValue]="'18682251210'"></nz-option>
                  <nz-option required [nzLabel]="'18819448274'" [nzValue]="'18819448274'"></nz-option>
                </nz-select>
              </div>
              <div nz-col nzSpan="1"></div>
              <div nz-col nzSpan="3">
                <button nz-button nzType="primary" (click)="doSave('sendMsg')" [disabled]="accountData.countDown !== 60">{{accountData.countDown === 60 ? '获取验证码' : accountData.countDown + 's'}}</button>
              </div>
            </div>
            <div nz-row>
              <div nz-col nzSpan="5"></div>
              <div nz-col nzSpan="3">
                <input nz-input nzSize="default" placeholder="请输入验证码" [(ngModel)]="accountData.code">
              </div>
            </div>
            <ng-template #rechargeModalFooter>
              <button nz-button nzType="primary" (click)="doSave('recharge')"><i class="anticon anticon-save"></i>确定充值</button>
              <button nz-button nzType="default" (click)="hideModal('recharge')"><i class="anticon anticon-close-circle-o"></i>放弃充值</button>
            </ng-template>
          </nz-modal>


          <nz-modal [(nzVisible)]="visiable.capital" nzWidth="950" nzTitle="资金流水" [nzFooter]="capitalModalFooter" (nzOnCancel)="hideModal('capital')" nzMaskClosable="false">
           <div nz-row>
              <form [formGroup]="capitalSearchForm">
                <div nz-col nzSpan="2" class="right_alignment">订单类型：</div>
                <div nz-col nzSpan="3">
                  <input nz-input placeholder="请输入订单类型" formControlName="orderType" nzSize="default">
                </div>
                <div nz-col nzSpan="2" class="right_alignment">时间范围：</div>
                <div nz-col nzSpan="7">
                    <nz-range-picker [nzFormat]="'yyyyMMdd'" formControlName="date" [(ngModel)]="dateRange" nzShowTime [nzShowToday]="true" ngModel [nzRanges]="commonService.dateSearch" (ngModelChange)="onChange($event, 'capital')"></nz-range-picker>
                </div>
              </form>
              <div nz-col nzSpan="8"></div>
              <div nz-col nzSpan="2">
                <button nz-button nzType="primary" (click)="loadData('capital')"><i class="anticon anticon-search"></i>查询</button>
              </div>
            </div>
            <nz-table nzBordered #capitalTable [nzData]="dataCapital.trades" *ngIf="!isSpinning">
              <thead>
                <tr>
                  <th>序号</th>
                  <th>订单类型</th>
                  <th>订单金额</th>
                  <th>订单号</th>
                  <th>下单时间</th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let data of capitalTable.data; let i=index;">
                  <td>{{i+1}}</td>
                  <td>{{data.orderType}}</td>
                  <td>{{data.orderAmount}}</td>
                  <td>{{data.orderNo}}</td>
                  <td>{{data.tradeTime}}</td>
                </tr>
              </tbody>
            </nz-table>
            <ng-template #capitalModalFooter>
              <div nz-row>
                <div nz-col nzSpan="3">客户ID：</div>
                <div nz-col nzSpan="5" class="left_alignment">{{accountData.customerId}}</div>
                <div nz-col nzSpan="2">余额：</div>
                <div nz-col nzSpan="3" class="left_alignment">{{accountData.accountBalance}}</div>
                <div nz-col nzSpan="3">消费总额：</div>
                <div nz-col nzSpan="3" class="left_alignment">{{dataCapital.consumeAmount}}</div>
              </div>
            </ng-template>
          </nz-modal>

        </nz-tab>

      </nz-tabset>
    </nz-card-tab>
  </nz-card>
</div>
